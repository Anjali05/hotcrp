var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Math.trunc",function(a){return a?a:function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var b=Math.floor(Math.abs(a));return 0>a?-b:b}},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var l=a[e];if(b.call(c,l,e,a))return{i:e,v:l}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");var siteurl,siteurl_postvalue,siteurl_suffix,siteurl_defaults,siteurl_absolute_base,siteurl_cookie_params,assetsurl,hotcrp_paperid,hotcrp_status,hotcrp_user,hotcrp_pc,hotcrp_want_override_conflict;
function $$(a){return document.getElementById(a)}function serialize_object(a){if("string"===typeof a)return a;if(a){var b,c,d=[];for(b in a)null!=(c=a[b])&&d.push(encodeURIComponent(b)+"="+encodeURIComponent(c));return d.join("&")}return""}window.JSON&&window.JSON.parse||(window.JSON={parse:$.parseJSON});var hasClass,addClass,removeClass,toggleClass,classList;
"classList"in document.createElement("span")&&!/MSIE|rv:11\.0/.test(navigator.userAgent||"")?(hasClass=function(a,b){return(a=a.classList)&&a.contains(b)},addClass=function(a,b){a.classList.add(b)},removeClass=function(a,b){a.classList.remove(b)},toggleClass=function(a,b,c){a.classList.toggle(b,c)},classList=function(a){return a.classList}):(hasClass=function(a,b){return $(a).hasClass(b)},addClass=function(a,b){$(a).addClass(b)},removeClass=function(a,b){$(a).removeClass(b)},toggleClass=function(a,
b,c){$(a).toggleClass(b,c)},classList=function(a){a=$.trim(a.className);return""===a?[]:a.split(/\s+/)});function add_callback(a,b){return a&&b?function(){a.apply(this,arguments);b.apply(this,arguments)}:a||b}function HPromise(a){this.value=a;this.state=void 0===a?!1:1;this.c=[]}HPromise.prototype.then=function(a,b){var c=new HPromise;this.c.push([b,a,c]);!1!==this.state?this._resolve():this.on&&(this.on(this),this.on=null);return c};
HPromise.prototype._resolve=function(){var a;for(a in this.c){var b=this.c[a];var c=b[this.state];if($.isFunction(c))try{var d=c(this.value);b[2].fulfill(d)}catch(e){b[2].reject(e)}else b[2][this.state?"fulfill":"reject"](this.value)}this.c=[]};HPromise.prototype.fulfill=function(a){!1===this.state&&(this.value=a,this.state=1,this._resolve())};HPromise.prototype.reject=function(a){!1===this.state&&(this.value=a,this.state=0,this._resolve())};
HPromise.prototype.onThen=function(a){this.on=add_callback(this.on,a);return this};
function log_jserror(a,b,c){!b&&a instanceof Error?(b=a,a={error:b.toString()}):"string"===typeof a&&(a={error:a});b&&b.fileName&&!a.url&&(a.url=b.fileName);b&&b.lineNumber&&!a.lineno&&(a.lineno=b.lineNumber);b&&b.columnNumber&&!a.colno&&(a.colno=b.columnNumber);b&&b.stack&&(a.stack=b.stack);(null==a.lineno||1<a.lineno)&&$.ajax(hoturl_post("api/jserror"),{global:!1,method:"POST",cache:!1,data:a});b&&!c&&"object"===typeof console&&console.error&&console.error(a.error)}
(function(){var a=window.onerror,b=0;window.onerror=function(c,d,e,l,k){if((d||!e)&&10>=++b){var g={error:c,url:d,lineno:e};l&&(g.colno=l);log_jserror(g,k,!0)}return a?a.apply(this,arguments):!1}})();function jqxhr_error_message(a,b,c){return"parsererror"===b?"Internal error: bad response from server.":c?c.toString():"timeout"===b?"Connection timed out.":b?"Failed ["+b+"].":"Failed."}
$(document).ajaxError(function(a,b,c,d){if(4==b.readyState){if(b.responseText&&"{"===b.responseText.charAt(0))try{var e=JSON.parse(b.responseText)}catch(l){}e&&e.user_error||(a=url_absolute(c.url)+" API failure: ",hotcrp_user&&hotcrp_user.email&&(a+="user "+hotcrp_user.email+", "),a+=b.status,d&&(a+=", "+d),b.responseText&&(a+=", "+b.responseText.substr(0,100)),log_jserror(a))}});
$.ajaxPrefilter(function(a,b,c){function d(a,b,c){if(e){if(/application\/json/.test(a.getResponseHeader("Content-Type")||"")&&a.responseText)try{var d=JSON.parse(a.responseText)}catch(m){}if("object"!==typeof d||!1!==d.ok||"string"!==typeof d.error)d={ok:!1,error:jqxhr_error_message(a,b,c)};e(d,a,b)}}if(!1!==a.global){var e=a.success;a.error?$.isArray(a.error)?a.error.push(d):a.error=[a.error,d]:a.error=d;null==a.timeout&&(a.timeout=1E4);null==a.dataType&&(a.dataType="json")}});
jQuery.fn.extend({geometry:function(a){if(this[0]==window)var b={left:this.scrollLeft(),top:this.scrollTop()};else{if(1==this.length&&this[0].getBoundingClientRect){b=jQuery.extend({},this[0].getBoundingClientRect());if(a=window.pageXOffset)b.left+=a,b.right+=a;if(a=window.pageYOffset)b.top+=a,b.bottom+=a;"width"in b||(b.width=b.right-b.left,b.height=b.bottom-b.top);return b}b=this.offset()}b&&(b.width=a?this.outerWidth():this.width(),b.height=a?this.outerHeight():this.height(),b.right=b.left+b.width,
b.bottom=b.top+b.height);return b},scrollIntoView:function(){for(var a=this.geometry(),b=this[0].parentNode;b&&b.tagName&&"visible"===$(b).css("overflow-y");)b=b.parentNode;b=jQuery(b&&b.tagName?b:window).geometry();a.top<b.top?this[0].scrollIntoView():a.bottom>b.bottom&&this[0].scrollIntoView(!1);return this}});function geometry_translate(a,b,c){"object"===typeof b&&(c=b.top,b=b.left);a=jQuery.extend({},a);a.top+=c;a.right+=b;a.bottom+=c;a.left+=b;return a}
window.escape_entities=function(){var a=/[&<>"']/g,b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(c){return null===c||"number"===typeof c?c:c.replace(a,function(a){return b[a]})}}();window.urlencode=function(){var a=/%20|[!~*'()]/g,b={"%20":"+","!":"%21","~":"%7E","*":"%2A","'":"%27","(":"%28",")":"%29"};return function(c){return null===c||"number"===typeof c?c:encodeURIComponent(c).replace(a,function(a){return b[a]})}}();
window.urldecode=function(a){return null===a||"number"===typeof a?a:decodeURIComponent(a.replace(/\+/g,"%20"))};function text_to_html(a){var b=document.createElement("div");b.appendChild(document.createTextNode(a));return b.innerHTML}function text_eq(a,b){if(a===b)return!0;a=(null==a?"":a).replace(/\r\n?/g,"\n");b=(null==b?"":b).replace(/\r\n?/g,"\n");return a===b}function regexp_quote(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}
function plural_noun(a,b){$.isArray(a)&&(a=a.length);return 1==a?b:"this"==b?"these":/^.*?(?:s|sh|ch|[bcdfgjklmnpqrstvxz][oy])$/.test(b)?"y"==b.substr(-1)?b.substr(0,b.length-1)+"ies":b+"es":b+"s"}function plural(a,b){$.isArray(a)&&(a=a.length);return a+" "+plural_noun(a,b)}function ordinal(a){return 1<=a&&3>=a?a+["st","nd","rd"][Math.floor(a-1)]:a+"th"}function commajoin(a,b){var c=a.length;b=b||"and";return 0==c?"":1==c?a[0]:2==c?a[0]+" "+b+" "+a[1]:a.slice(0,c-1).join(", ")+", "+b+" "+a[c-1]}
function common_prefix(a,b){for(var c=0;c!=a.length&&c!=b.length&&a.charAt(c)==b.charAt(c);)++c;return a.substring(0,c)}function count_words(a){return((a||"").match(/[^-\s.,;:<>!?*_~`#|]\S*/g)||[]).length}function count_words_split(a,b){return(b=(new RegExp("^((?:[-\\s.,;:<>!?*_~`#|]*[^-\\s.,;:<>!?*_~`#|]\\S*(?:\\s|$)\\s*){"+b+"})([\\d\\D]*)$")).exec(a||""))?[b[1],b[2]]:[a||"",""]}
function sprintf(a){var b=a.split(/(%(?:%|-?(?:\d*|\*?)(?:\.\d*)?[sdefgoxX]))/),c,d,e="";var l=0;for(c=1;l!=b.length;++l){var k=b[l];if("%"!=k.charAt(0))e+=k;else if("%"==k.charAt(1))e+="%";else{var g=arguments[c];++c;k=k.match(/^%(-?)(\d*|\*?)(?:|[.](\d*))(\w)/);"*"==k[2]&&(k[2]=g.toString(),g=arguments[c],++c);"e"<=k[4]&&"g">=k[4]&&null==k[3]&&(k[3]=6);"g"==k[4]?(g=Number(g).toPrecision(k[3]).toString(),g=g.replace(/\.(\d*[1-9])?0+(|e.*)$/,function(a,b,c){return(null==b?"":"."+b)+c})):"f"==k[4]?
g=Number(g).toFixed(k[3]):"e"==k[4]?g=Number(g).toExponential(k[3]):"d"==k[4]?g=Math.floor(g):"o"==k[4]?g=Math.floor(g).toString(8):"x"==k[4]?g=Math.floor(g).toString(16):"X"==k[4]&&(g=Math.floor(g).toString(16).toUpperCase());g=g.toString();if(""!==k[2]&&"0"!==k[2])for(d="0"===k[2].charAt(0)?"0":" ";g.length<parseInt(k[2],10);)g=k[1]?g+d:d+g;e+=g}}return e}function now_msec(){return(new Date).getTime()}function now_sec(){return now_msec()/1E3}
window.strftime=function(){function a(a,b,e){b+=a.toString();return b.length<=e?b:b.substr(b.length-e)}var b={a:function(a){return"Sun Mon Tue Wed Thu Fri Sat".split(" ")[a.getDay()]},A:function(a){return"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")[a.getDay()]},d:function(b){return a(b.getDate(),"0",2)},e:function(b,d){return a(b.getDate(),d?"":" ",2)},u:function(a){return a.getDay()||7},w:function(a){return a.getDay()},b:function(a){return"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getMonth()]},
B:function(a){return"January February March April May June July August September October November December".split(" ")[a.getMonth()]},h:function(a){return b.b(a)},m:function(b){return a(b.getMonth()+1,"0",2)},y:function(a){return a.getFullYear()%100},Y:function(a){return a.getFullYear()},H:function(b){return a(b.getHours(),"0",2)},k:function(b,d){return a(b.getHours(),d?"":" ",2)},I:function(b){return a(b.getHours()%12||12,"0",2)},l:function(b,d){return a(b.getHours()%12||12,d?"":" ",2)},M:function(b){return a(b.getMinutes(),
"0",2)},p:function(a){return 12>a.getHours()?"AM":"PM"},P:function(a){return 12>a.getHours()?"am":"pm"},r:function(a,b){return b&&a.getSeconds()?strftime("%#l:%M:%S%P",a):b&&a.getMinutes()?strftime("%#l:%M%P",a):b?strftime("%#l%P",a):strftime("%I:%M:%S %p",a)},R:function(a,b){return b&&a.getSeconds()?strftime("%H:%M:%S",a):strftime("%H:%M",a)},S:function(b){return a(b.getSeconds(),"0",2)},T:function(a){return strftime("%H:%M:%S",a)},D:function(a){return strftime("%m/%d/%y",a)},F:function(a){return strftime("%Y-%m-%d",
a)},s:function(a){return Math.trunc(a.getTime()/1E3)},n:function(a){return"\n"},t:function(a){return"\t"},"%":function(a){return"%"}};return function(a,d){a=a.split(/(%#?\S)/);var c,l,k="";null==d?d=new Date:"number"==typeof d&&(d=new Date(1E3*d));for(c=0;c!=a.length;++c){var g=a[c];var f="#"==g.charAt(1);k="%"==g.charAt(0)&&(l=b[g.charAt(1+f)])?k+l(d,f):k+g}return k}}();
function unparse_interval(a,b,c){b=b||now_sec();c=c||0;var d=Math.abs(b-a),e=0;if(2592E3<=d){if(!(c&1))return strftime((c&4?"":"on ")+"%#e %b %Y",a);e=5}else 259200<=d?e=4:28800<=d?e=3:3630<=d?e=2:180.5<=d&&(e=1);var l=[1,60,1800,3600,86400,604800][e];d=Math.ceil((d-l/2)/l);2==e&&(d/=2);d=c&4?d+"smhhdw".charAt(e):d+(" second; minute; hour; hour; day; week".split(";")[e]+(1==d?"":"s"));return c&2?d:a<b?d+" ago":"in "+d}unparse_interval.NO_DATE=1;unparse_interval.NO_PREP=2;unparse_interval.SHORT=4;
function event_prevent(a){a.preventDefault?a.preventDefault():a.returnValue=!1}
var event_key=function(){function a(a){var e;if("string"===typeof a)return a;if(null!=(e=a.key))return b[e]||e;if(e=a.charCode)return c[e]||String.fromCharCode(e);if(e=a.keyCode){if(d[e])return d[e];if(48<=e&&57>=e||65<=e&&90>=e)return String.fromCharCode(e)}return""}var b={Spacebar:" ",Esc:"Escape"},c={9:"Tab",13:"Enter",27:"Escape"},d={9:"Tab",13:"Enter",16:"ShiftLeft",17:"ControlLeft",18:"AltLeft",20:"CapsLock",27:"Escape",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",
91:"OSLeft",92:"OSRight",93:"OSRight",224:"OSLeft",225:"AltRight"},e={Alt:2,AltLeft:2,AltRight:2,CapsLock:2,Control:2,ControlLeft:2,ControlRight:2,Meta:2,OSLeft:2,OSRight:2,Shift:2,ShiftLeft:2,ShiftRight:2,ArrowLeft:1,ArrowRight:1,ArrowUp:1,ArrowDown:1,Backspace:1,Enter:1,Escape:1,PageUp:1,PageDown:1,Tab:1};a.printable=function(b){return!e[a(b)]&&("string"===typeof b||!(b.ctrlKey||b.metaKey))};a.modifier=function(b){return 1<e[a(b)]};a.is_default_a=function(a,b){return!a.metaKey&&!a.ctrlKey&&2!=a.which&&
(!b||!/(?:^|\s)(?:ui|btn)(?=\s|$)/i.test(b.className||""))};return a}();function event_modkey(a){return(a.shiftKey?1:0)+(a.ctrlKey?2:0)+(a.altKey?4:0)+(a.metaKey?8:0)}event_modkey.SHIFT=1;event_modkey.CTRL=2;event_modkey.ALT=4;event_modkey.META=8;function make_onkey(a,b){return function(c){event_modkey(c)||event_key(c)!=a||(c.preventDefault(),c.stopImmediatePropagation(),b.call(this,c))}}var wstorage=function(){return!1};
try{window.localStorage&&window.JSON&&(wstorage=function(a,b,c){try{var d=a?window.sessionStorage:window.localStorage;return"undefined"===typeof b?!!d:"undefined"===typeof c?d.getItem(b):null===c?d.removeItem(b):"object"===typeof c?d.setItem(b,JSON.stringify(c)):d.setItem(b,c)}catch(e){return!1}})}catch(a){}wstorage.json=function(a,b){return(a=wstorage(a,b))?JSON.parse(a):!1};
function hoturl_add(a,b){var c=a.indexOf("#");0<=c&&(b+=a.substring(c),a=a.substring(0,c));return a+(0>a.indexOf("?")?"?":"&")+b}function hoturl_find(a,b){for(var c,d=0;d<a.v.length;++d)if(c=b.exec(a.v[d]))return[d,c[1]];return null}function hoturl_clean(a,b,c){!1!==a.last&&a.v.length&&((b=hoturl_find(a,b))?(a.last=b[1],a.t+="/"+b[1],a.v.splice(b[0],1)):c||(a.last=!1))}
function hoturl(a,b){var c,d="";if(null==siteurl||null==siteurl_suffix)siteurl=siteurl_suffix="",log_jserror("missing siteurl");var e={t:a+siteurl_suffix};if("string"===typeof b){"?"===b.charAt(0)&&(b=b.substr(1));if(c=b.match(/^(.*?)(#.*)$/))b=c[1],d=c[2];e.v=b.split(/&/)}else for(c in e.v=[],b){var l=b[c];null!=l&&("anchor"===c?d="#"+l:e.v.push(encodeURIComponent(c)+"="+encodeURIComponent(l)))}"api"!==a.substr(0,3)||hoturl_find(e,/^base=/)||e.v.push("base="+encodeURIComponent(siteurl));if("paper"===
a){if(hoturl_clean(e,/^p=(\d+)$/),hoturl_clean(e,/^m=(\w+)$/),"api"===e.last){hoturl_clean(e,/^fn=(\w+)$/);var k=!0}}else"review"===a?hoturl_clean(e,/^r=(\d+[A-Z]+)$/):"help"===a?hoturl_clean(e,/^t=(\w+)$/):"api"===a.substr(0,3)?(3<a.length&&(e.t="api"+siteurl_suffix,e.v.push("fn="+a.substr(4))),hoturl_clean(e,/^p=(\d+)$/,!0),hoturl_clean(e,/^fn=(\w+)$/),k=!0):"doc"===a&&hoturl_clean(e,/^file=([^&]+)$/);hotcrp_want_override_conflict&&k&&!hoturl_find(e,/^forceShow=/)&&e.v.push("forceShow=1");siteurl_defaults&&
e.v.push(serialize_object(siteurl_defaults));e.v.length&&(e.t+="?"+e.v.join("&"));return siteurl+e.t+d}function hoturl_post(a,b){b="string"===typeof b?b+((b?"&":"")+"post="+siteurl_postvalue):$.extend({post:siteurl_postvalue},b);return hoturl(a,b)}function hoturl_html(a,b){return escape_entities(hoturl(a,b))}function hoturl_post_html(a,b){return escape_entities(hoturl_post(a,b))}
function url_absolute(a,b){var c="",d;b=b||window.location.href;!/^\w+:\/\//.test(a)&&(d=b.match(/^(\w+:)/))&&(c=d[1]);c&&!/^\/\//.test(a)&&(d=b.match(/^\w+:(\/\/[^\/]+)/))&&(c+=d[1]);if(c&&!/^\//.test(a)&&(d=b.match(/^\w+:\/\/[^\/]+(\/[^?#]*)/)))for(c=(c+d[1]).replace(/\/[^\/]+$/,"/");"../"==a.substring(0,3);)c=c.replace(/\/[^\/]*\/$/,"/"),a=a.substring(3);return c+a}
function hoturl_absolute_base(){siteurl_absolute_base||(siteurl_absolute_base=url_absolute(siteurl));return siteurl_absolute_base}function hoturl_go(a,b){window.location=hoturl(a,b)}function hoturl_post_go(a,b){var c=$('<form method="POST" enctype="multipart/form-data" accept-charset="UTF-8"><div><input type="hidden" name="____empty____" value="1"></div></form>');c[0].action=hoturl_post(a,b);c.appendTo(document.body);c.submit()}
function render_xmsg(a,b){"string"===typeof b&&(b=""===b?[]:[b]);if(0===b.length)return"";b=1===b.length?b[0]:"<p>"+b.join("</p><p>")+"</p>";if(0===a||1===a||2===a)a=["info","warning","error"][a];return'<div class="msg msg-'+a+'">'+b+"</div>"}
var handle_ui=function(a){function b(a){var b=a.target;(b&&hasClass(b,"ui")||"A"===this.tagName&&hasClass(this,"ui"))&&a.preventDefault();b=classList(this);for(var d=0;d<b.length;++d){var k=c[b[d]];if(k)for(var g=0;g<k.length;++g)k[g].call(this,a)}}var c={};b.on=function(a,b){c[a]=c[a]||[];c[a].push(b)};return b}($);$(document).on("click",".ui, .uix",handle_ui);$(document).on("change",".uich",handle_ui);$(document).on("keydown",".uikd",handle_ui);
handle_ui.on("js-range-click",function(a){var b=$(this).closest("form"),c=!1;"keydown"!==a.type||event_modkey(a)||(c=event_key(a));if(!(b[0].hasAttribute("data-range-clicking")||"keydown"===a.type&&"ArrowDown"!==c&&"ArrowUp"!==c)){var d=this.getAttribute("data-range-type"),e=d?"[data-range-type~='"+d+"']":"[name='"+this.name+"']";d=b.find("input[type="+this.type+"]"+e);var l=b.data("rangeClickLast")||{},k=l[e],g,f,m;for(m=0;m!=d.length;++m)d[m]==this&&(g=m),d[m]==k&&(f=m);if(c)0!==g&&"ArrowUp"===
c?--g:g<d.length-1&&"ArrowDown"===c&&++g,$(d[g]).focus().scrollIntoView(),a.preventDefault();else if(l[e]=this,b.data("rangeClickLast",l),a.shiftKey&&k){f<=g?(m=f,a=g-1):(m=g+1,a=f);for(b[0].setAttribute("data-range-clicking","y");m<=a;++m)d[m].checked!==this.checked&&$(d[m]).trigger("click");b[0].removeAttribute("data-range-clicking")}}});
var make_bubble=function(){function a(a){var b=a.match(/^rgb\((.*)\)$/);return b?"rgba("+b[1]+", 1)":a}var b=["Top","Right","Bottom","Left"],c=["top","right","bottom","left"],d=["height","width"],e=Math.round;window.devicePixelRatio&&1<window.devicePixelRatio&&(e=function(a){return function(b){return Math.round(b*a)/a}}(window.devicePixelRatio));return function(l,k){function g(){var d=[0,0,0,0],e=z[1],g=z[0]/2;x=parseFloat($(u).css("border"+b[C]+"Width"));x!==x&&(x=0);d[C^1]=d[C^3]=g+"px";d[C^2]=
e+"px";A[0].style.borderWidth=d.join(" ");d[C^1]=d[C^3]=g+"px";d[C^2]=e+"px";A[2].style.borderWidth=d.join(" ");for(d=1;3>=d;++d)A[0].style[c[C^d]]=A[2].style[c[C^d]]="";A[0].style[c[C]]=-e-x+"px";A[2].style[c[C]]=-e-x+x/g*Math.sqrt(e*e+g*g)+"px";for(d=0;3>d;d+=2)A[d].style.borderLeftColor=A[d].style.borderRightColor=A[d].style.borderTopColor=A[d].style.borderBottomColor="transparent";e=a($(u).css("backgroundColor")).replace(/([\d.]+)\)/,function(a,b){return.75*b+.25+")"});A[0].style["border"+b[C^
2]+"Color"]=$(u).css("border"+b[C]+"Color");assign_style_property(A[2],"border"+b[C^2]+"Color",e)}function f(a,b,d,e){var g=a[c[d]];a=a[c[d^2]];return Math.min(Math.max((1-e)*g+e*a,Math.min(a,b[c[d]]+8)),Math.max(g,b[c[d^2]]-8))}function m(a,b,e,g,m,f){var h=b[c[g]];b=b[c[g^2]];e=e[d[g&1]];m=a-m*e;!f&&m<h+8?m=Math.min(a-z[0],h+8):!f&&m+e>b-8&&(m=Math.max(a+z[0]-e,b-8-e));return m}function h(a,b){var c=Math.max(3===b?0:B.left-a.left,1===b?0:a.right-B.right);return("h"===b||1===b||3===b)&&100<c?Math.min(a.width,
c)-24:a.width-24}function r(a,b){var c=$(u);c.css("maxWidth","");var d=c.geometry(!0);a=h(a,b);a<d.width&&(c.css("maxWidth",a),d=c.geometry(!0));c=[B.top-z.bottom-d.height-z[0],B.right+z.left+d.width+z[0],B.bottom+z.top+d.height+z[0],B.left-z.right-d.width-z[0]];c.width=d.width;c.height=d.height;c.wconstraint=a;return c}function v(a,b,c){var d=h(b,c);if(d<a.wconstraint&&d<a.width||d>a.wconstraint&&a.width>=a.wconstraint)a=r(b,c);return a}function n(a,b){var c;return a.length>b&&0<=(c="0123trblnesw".indexOf(a.charAt(b)))?
c%4:-1}function w(a,b){a=$(u).css("border"+a+"Radius");var c;if(!a)return 0;-1<(c=a.indexOf(" "))&&(a=b?a.substring(c+1):a.substring(0,c));return parseFloat(a)}function y(a,c,e){if(e&1){var g=w(b[0]+b[e],1);var m=w(b[2]+b[e],1)}else g=w(b[e]+b[3],1),m=w(b[e]+b[1],1);return Math.min(Math.max(a,g),c[d[e&1^1]]-m-z[0])}function t(){if(!z){var a=$('<div class="bubble hidden'+E+'"><div class="bubtail bubtail0'+E+'"></div></div>').appendTo(document.body),d=a.children(),h,k=[d.width(),d.height()];for(d=0;4>
d;++d)k[c[d]]=0,(h=a.css("margin"+b[d]))&&(h=parseFloat(h))&&(k[c[d]]=h);a.remove();z=k}null==H&&(H="r");var l=/!/.test(H);d=/\*/.test(H);h=H.replace(/[^a0-3neswtrblhv]/,"");a=n(h,0);k=n(h,1);k=0<=a&&0<=k&&(k&1)!=(a&1)?1===k||2===k?1:0:.5;0>a&&(a=/^[ahv]$/.test(h)?h:"a");var p=$(window).geometry();h=r(p,h);"a"===a&&(h.height+z[0]>Math.max(B.top-p.top,p.bottom-B.bottom)?(a="h",h=v(h,p,a)):a="v");var w=[p.top+24,p.right-24,p.bottom-24,p.left+24];("v"===a||0===a||2===a)&&!l&&0>k&&h[2]>w[2]&&h[0]<w[0]&&
(h[3]>=w[3]||h[1]<=w[1])&&(a="h",h=v(h,p,a));a="v"===a&&h[2]>w[2]&&h[0]>w[0]||0===a&&!l&&h[2]>p.bottom&&p.top-h[0]<h[2]-p.bottom||2===a&&(l||h[0]>=p.top+8)?2:"v"===a||0===a||2===a?0:"h"===a&&h[3]-p.left<p.right-h[1]||1===a&&!l&&h[3]<p.left||3===a&&(l||h[1]<=p.right-8)?3:1;h=v(h,p,a);a!==C&&(C=a,g());l=parseFloat($(u).css("border"+b[a&1?0:3]+"Width"));a&1?(w=f(B,p,0,k),k=m(w,p,h,0,k,d),p=y(e(w-k-z[0]/2-l),h,a),A[0].style.top=A[2].style.top=p+"px",d=1==a?B.left-z.right-h.width-z[1]-1:B.right+z.left+
z[1]):(w=f(B,p,3,k),d=m(w,p,h,3,k,d),p=y(e(w-d-z[0]/2-l),h,a),A[0].style.left=A[2].style.left=p+"px",k=0==a?B.bottom+z.top+z[1]:B.top-z.bottom-h.height-z[1]-1);u.style.left=e(d)+"px";u.style.top=e(k)+"px";u.style.visibility="visible"}function D(){u&&u.parentElement.removeChild(u);u=null}!k&&l&&"object"===typeof l?(k=l,l=k.content):k?"string"===typeof k&&(k={color:k}):k={};var B=null,H=k.dir,C=null,E=k.color?" "+k.color:"",u=$('<div class="bubble'+E+'" style="margin:0"><div class="bubtail bubtail0'+
E+'" style="width:0;height:0"></div><div class="bubcontent"></div><div class="bubtail bubtail1'+E+'" style="width:0;height:0"></div></div>')[0];document.body.appendChild(u);k["pointer-events"]&&$(u).css({"pointer-events":k["pointer-events"]});var A=u.childNodes,z=null,x=null,p={near:function(a,b){var d;if("string"===typeof a||a.tagName||a.jquery)a=$(a),null==H&&a[0]&&(H=a[0].getAttribute("data-tooltip-dir")),a=a.geometry(!0);for(d=0;4>d;++d)!(c[d]in a)&&c[d^2]in a&&(a[c[d]]=a[c[d^2]]);b&&(b=$(b))&&
b.length&&b[0]!=window&&(a=geometry_translate(a,b.geometry()));B=a;t();return p},at:function(a,b,c){return p.near({top:b,left:a},c)},dir:function(a){H=a;return p},remove:D,color:function(a){a=a?" "+a:"";E!==a&&(E=a,u.className="bubble"+E,A[0].className="bubtail bubtail0"+E,A[2].className="bubtail bubtail1"+E,C=z=null,B&&t());return p},html:function(a){var b=A[1];if(void 0===a)return b.innerHTML;if("string"===typeof a&&a===b.innerHTML&&"visible"===u.style.visibility)return p;B&&$(u).css({maxWidth:"",
left:"",top:""});if("string"===typeof a)b.innerHTML=a;else{for(;b.childNodes.length;)b.removeChild(b.childNodes[0]);a&&a.jquery?a.appendTo(b):b.appendChild(a)}B&&t();return p},text:function(a){return void 0===a?$(A[1]).text():p.html(a?text_to_html(a):a)},hover:function(a,b){$(u).hover(a,b);return p},removeOn:function(a,b){if(1<arguments.length)$(a).on(b,D);else if(u)$(u).on(a,D);return p},self:function(){return u?$(u):null},outerHTML:function(){return u?u.outerHTML:null}};l&&p.html(l);return p}}(),
tooltip=function(a){function b(b,c){var d=b.getAttribute("data-tooltip-info");d&&("string"===typeof d&&"{"===d.charAt(0)?d=JSON.parse(d):"string"===typeof d&&(d={builder:d}),c=a.extend(d,c));c.builder&&k[c.builder]&&(c=k[c.builder].call(b,c)||c);if(null==c.dir||b.hasAttribute("data-tooltip-dir"))c.dir=b.getAttribute("data-tooltip-dir")||"v";if(null==c.type||b.hasAttribute("data-tooltip-type"))c.type=b.getAttribute("data-tooltip-type");if(null==c.className||b.hasAttribute("data-tooltip-class"))c.className=
b.getAttribute("data-tooltip-class")||"dark";b.hasAttribute("data-tooltip")?c.content=b.getAttribute("data-tooltip"):null==c.content&&b.hasAttribute("aria-label")&&(c.content=b.getAttribute("aria-label"));return c}function c(c){function d(){l=clearTimeout(l);k&&k.remove();g.removeData("tooltipState");window.global_tooltip===t&&(window.global_tooltip=null)}function e(){y&&!k?(k=make_bubble(y,{color:"tooltip "+c.className,dir:c.dir}),k.near(c.near||c.element).hover(t.enter,t.exit)):y?k.html(y):k&&(k&&
k.remove(),k=null)}function h(a){if(a instanceof HPromise)a.then(h);else{var b=window.global_tooltip;y=a;b&&b._element===c.element&&b.html()===y&&!c.done?t=b:(b&&b.erase(),g.data("tooltipState",t),e(),window.global_tooltip=t)}}if(window.disable_tooltip)return null;var g=a(this);c=b(g[0],a.extend({},c||{}));c.element=this;var k=null,l=null,w=0,y=c.content;var t={enter:function(){l=clearTimeout(l);++w;return t},exit:function(){var a="focus"===c.type?0:200;l=clearTimeout(l);0==--w&&"sticky"!==c.type&&
(l=setTimeout(d,a));return t},erase:d,_element:g[0],html:function(a){if(void 0===a)return y;y=a;e();return t},text:function(a){return t.html(escape_entities(a))}};h(y);c.done=!0;return t}function d(){var b=a(this).data("tooltipState")||c.call(this);b&&b.enter()}function e(){var b=a(this).data("tooltipState");b&&b.exit()}function l(){var b=a(this).removeClass("need-tooltip");if("focus"===b[0].getAttribute("data-tooltip-type"))b.on("focus",d).on("blur",e);else b.hover(d,e)}var k={};l.erase=function(){var b=
this===l?window.global_tooltip:a(this).data("tooltipState");b&&b.erase()};l.add_builder=function(a,b){k[a]=b};a(function(){a(".need-tooltip").each(l)});return l}($);
"[object OperaMini]"!==Object.prototype.toString.call(window.operamini)&&"placeholder"in document.createElement("input")&&"placeholder"in document.createElement("textarea")?window.mktemptext=$.noop:(window.mktemptext=function(){function a(a){var b=$(this),d=b.attr("placeholder"),e=b.val();"focus"==a.type&&e===d&&b.val("");"blur"==a.type&&""===e|e===d&&b.val(d);b.toggleClass("temptext","focus"!=a.type&&(""===e||e===d))}return function(b){b.find("input[placeholder], textarea[placeholder]").each(function(){hasClass(this,
"has-mktemptext")||($(this).on("focus blur change input",a).addClass("has-mktemptext"),a.call(this,{type:"blur"}))})}}(),$(function(){mktemptext($(document))}));window.assign_style_property=function(){var a=document.createElement("div");try{return a.style.outline="4px solid rgba(9,9,9,0.3)",function(a,c,d){a.style[c]=d}}catch(b){return function(a,b,e){e=e.replace(/\brgba\((.*?),\s*[\d.]+\)/,"rgb($1)");a.style[b]=e}}}();
window.setLocalTime=function(){function a(a,e){a&&"string"==typeof a&&(a=$$(a));a&&c&&(e=new Date(1E3*e),e=b?strftime("%A %#e %b %Y %#R your time",e):strftime("%A %#e %b %Y %#r your time",e),a.innerHTML="SPAN"==a.tagName?" ("+e+")":e,removeClass(a,"hidden"))}var b,c=!1;a.initialize=function(a,e){b=e;c=60<=Math.abs((new Date).getTimezoneOffset()-a)};return a}();
window.hotcrp_deadlines=function(a){function b(a,b,c){if(+n.now<=b?a-120<=b:c)return y=b,!0}function c(a){var c="",e,m,h=now_sec(),g=+n.now+(h-+n.load),f=$$("maindeadline");if(f){!a&&3E5<=Math.abs(h-n.now)&&(m=$$("clock_drift_container"))&&(m.innerHTML="<div class='warning'>The HotCRP server\u2019s clock is more than 5 minutes off from your computer\u2019s clock. If your computer\u2019s clock is correct, you should update the server\u2019s clock.</div>");w="";y=0;n.sub||log_jserror("bad dl "+JSON.stringify(n));
n.sub.open&&(b(g,+n.sub.reg,n.sub.reg_ingrace)?w="Registration":b(g,+n.sub.update,n.sub.update_ingrace)?w="Update":b(g,+n.sub.sub,n.sub.sub_ingrace)&&(w="Submission"));if(!w&&n.resps)for(e in n.resps)if(m=n.resps[e],m.open&&+m.open<g&&b(g,+m.done,m.ingrace)){w="1"==e?"Response":e+" response";break}w&&(c='<a href="'+hoturl_html("deadlines")+'">'+w+" deadline</a> ",c=!y||.5>y-g?c+"is NOW":c+unparse_interval(y,g),!y||180.5>y-g)&&(c='<span class="impending">'+c+"</span>");(f.innerHTML=c)?removeClass(f,
"hidden"):addClass(f,"hidden");!B&&w&&(!y||180.5>y-g?B=setTimeout(d,250):3600>=y-g&&(B=setTimeout(d,1E3*(Math.min(g+15,y-180.25)-g))))}}function d(){B=null;c()}function e(){var a=wstorage.json(!0,"hotcrp-tracking");a&&!a[2]&&n.tracker&&n.tracker.trackerid==a[1]&&n.tracker.start_at&&(a=[a[0],a[1],n.tracker.start_at,a[3]],wstorage(!0,"hotcrp-tracking",a));return a}function l(){var a;return n.tracker&&(a=e())&&n.tracker.trackerid==a[1]}function k(a,b){var c=hoturl("paper",{p:b.pid}),d=[];a='<td class="trackerdesc">'+
(0==a?"Currently:":1==a?"Next:":"Then:")+'</td><td class="trackerpid">';b.pid&&(a+='<a class="uu" href="'+escape_entities(c)+'">#'+b.pid+"</a>");a+='</td><td class="trackerbody">';b.title&&(d.push('<a class="uu'+(b.format?' ptitle need-format" data-format="'+b.format:"")+'" href="'+c+'">'+text_to_html(b.title)+"</a>"),b.format&&(u=!0));for(c=0;c!=x.length;++c)b[x[c][0]]&&d.push('<span class="tracker'+x[c][0]+'">'+x[c][1]+"</span>");return a+d.join(" &nbsp;&#183;&nbsp; ")+"</td>"}function g(){A&&(clearTimeout(A),
A=null);if(n.tracker&&!n.tracker_hidden&&n.tracker.position_at){var b=now_sec()-(n.tracker.position_at+n.load-n.now),c=Math.round(b);c=3600<=c?sprintf("%d:%02d:%02d",c/3600,c/60%60,c%60):sprintf("%d:%02d",c/60,c%60);a("#trackerelapsed").html(c);A=setTimeout(g,1E3-1E3*b%1E3)}}function f(b){"number"!==typeof b&&(b=hasClass(this,"stop")?-1:hasClass(this,"start")?1:0);tooltip.erase();if(0>b)a.post(hoturl_post("api/track",{track:"stop"}),r),z&&(clearInterval(z),z=null);else if(wstorage()){var c=e();c&&
c[0]!=hoturl_absolute_base()&&(c=null);!b||c&&l()||(c=[hoturl_absolute_base(),Math.floor(1E5*Math.random()),null,document.body.getAttribute("data-hotlist")||null]);if(c){b="track="+c[1]+"%20x";var d={};hotcrp_paperid&&(b+="%20"+hotcrp_paperid+"&p="+hotcrp_paperid);c[2]&&(b+="&tracker_start_at="+c[2]);c[3]&&(d["hotlist-info"]=c[3]);a.post(hoturl_post("api/track",b),d,r);z||(z=setInterval(f,25E3,0));wstorage(!0,"hotcrp-tracking",c)}}}function m(){function b(a,b,d){var e=now_msec();p==c&&(p=null,"success"==
b&&200==d.status&&a&&a.ok&&(n.tracker_status==a.tracker_status||!a.tracker_status_at||!n.tracker_status_at||n.tracker_status_at+.005<=a.tracker_status_at)?(O=G=0,++J,v()):1E5<e-c?(Q=Math.max(Q/2,3E4),m()):3>++O?(setTimeout(m,128<<Math.min(O,12)),K(-1)):(G=e+1E4*Math.min(O,60),v()))}var c=now_msec(),d=Math.floor((J?Q:1E3)+1E3*Math.random());n.tracker_site&&!/^(?:https?:|\/)/.test(n.tracker_site)&&(n.tracker_site=url_absolute(n.tracker_site,hoturl_absolute_base()));n.tracker_site&&!/\/$/.test(n.tracker_site)&&
(n.tracker_site+="/");if(p||K(0))return!0;if(!n.tracker_site||G&&G>=c)return!1;p=c;a.ajax(hoturl_add(n.tracker_site+"poll","conference="+encodeURIComponent(hoturl_absolute_base())+"&poll="+encodeURIComponent(n.tracker_status)+"&tracker_status_at="+encodeURIComponent(n.tracker_status_at||0)+"&timeout="+d),{method:"GET",timeout:d+2E3,success:b,complete:function(a,c){b(null,c,a)}});return!0}function h(b,d){b&&(window.hotcrp_status=n=b);n.load=n.load||now_sec();n.perm=n.perm||{};n.myperm=n.perm[hotcrp_paperid]||
{};n.rev=n.rev||{};n.tracker_status=n.tracker_status||"off";H=!!n.tracker;if(n.tracker||n.tracker_status_at&&259200>n.load-n.tracker_status_at)C=n.load;c(d);b=a.Event("hotcrpdeadlines");a(window).trigger(b,[n]);for(var h in n.p||{})n.p[h].tags&&(b=a.Event("hotcrptags"),a(window).trigger(b,[n.p[h]]));if(C&&(!d||!l())){h=$$("tracker");b=$$("trackerspace");var f=l(),r;if(r=$$("trackerconnectbtn"))f?r.setAttribute("data-tooltip",'<div class="tooltipmenu"><div><a class="ttmenu" href="'+hoturl_html("buzzer")+
'" target="_blank">Discussion status page</a></div><div><a class="ui tracker-ui stop ttmenu" href="">Stop meeting tracker</a></div></div>'):r.setAttribute("data-tooltip","Start meeting tracker"),r.className=r.className.replace(/\btbtn(?:-on)*\b/,f?"tbtn-on":"tbtn");(H=!!n.tracker)?C=now_sec():e()&&wstorage(!0,"hotcrp-tracking",null);if(!n.tracker||hasClass(document.body,"hide-tracker"))h&&h.parentNode.removeChild(h),b&&b.parentNode.removeChild(b);else{r=document.body;b||(b=document.createElement("div"),
b.id="trackerspace",r.insertBefore(b,r.firstChild));h||(h=document.createElement("div"),h.id="tracker",r.insertBefore(h,r.firstChild),E=null);u=!1;r="";if(n.is_admin){var p='<div class="tooltipmenu"><div><a class="ttmenu" href="'+hoturl_html("buzzer")+'" target="_blank">Discussion status page</a></div></div>';r+='<div class="need-tooltip" id="trackerlogo" data-tooltip="'+escape_entities(p)+'"></div>';r+='<div style="float:right"><a class="ui tracker-ui stop closebtn need-tooltip" href="" data-tooltip="Stop meeting tracker">x</a></div>'}else r+=
'<div id="trackerlogo"></div>';n.tracker&&n.tracker.position_at&&(r+='<div style="float:right" id="trackerelapsed"></div>');if(n.tracker.papers&&n.tracker.papers[0]){r+='<table class="trackerinfo"><tbody><tr class="tracker0"><td rowspan="'+n.tracker.papers.length+'">';r+="</td>"+k(0,n.tracker.papers[0]);for(p=1;p<n.tracker.papers.length;++p)r+='</tr><tr class="tracker'+p+'">'+k(p,n.tracker.papers[p]);r+="</tr></tbody></table>"}else r+='<table class="trackerinfo"><tbody><tr><td><a href="'+siteurl+
n.tracker.url+'">Discussion list</a></td></tr></tbody></table>';r+='<hr class="c">';if(r!==E){E=r;h.className=n.tracker.papers&&n.tracker.papers[0].pid!=hotcrp_paperid?f?"active nomatch":"nomatch":f?"active":"match";f='<div class="trackerholder';n.tracker&&(n.tracker.listinfo||n.tracker.listid)&&(f+=' has-hotlist" data-hotlist="'+escape_entities(n.tracker.listinfo||n.tracker.listid));h.innerHTML=f+'">'+r+"</div>";a(h).find(".need-tooltip").each(tooltip);if(u)render_text.on_page();b.style.height=h.offsetHeight+
"px"}n.tracker&&n.tracker.position_at&&g()}}C&&K(1);if(!t){var x;d&&$$("clock_drift_container")?x=10:C&&m()||(x=C&&10800>n.load-C?1E4:w?900<=Math.abs(y-n.load)?3E5:120<=Math.abs(y-n.load)?9E4:45E3:18E5);x&&(t=setTimeout(v,x))}}function r(a){!0!==t&&clearTimeout(t);a.ok?(t=null,D=0,h(a)):(++D,t=setTimeout(v,1E4*Math.min(D,60)))}function v(){if(!0!==t){clearTimeout(t);t=!0;var b=hotcrp_deadlines.options||{};hotcrp_deadlines&&(b.p=hotcrp_paperid);b.fn="status";a.ajax(hoturl("api",b),{method:"GET",timeout:3E4,
success:r})}}var n,w,y,t,D=0,B,H,C,E,u,A,z,x=[["is_manager","Administrator"],["is_lead","Discussion lead"],["is_reviewer","Reviewer"],["is_conflict","Conflict"]];handle_ui.on("tracker-ui",f);var p,G,O=0,J=0,Q=26E4,K=function(){function b(){return"hotcrp-comet "+hoturl_absolute_base()}function c(a){(a=a&&JSON.parse(a))&&"object"===typeof a||(a={});!a.updated_at||a.updated_at+10<now_sec()||a.tracker_status!=n.tracker_status&&a.at<n.now?a.expired=!0:a.tracker_status!=n.tracker_status?a.fresh=!0:a.at==
g?a.owned=!0:a.same=!0;return a}function d(){g=n.now;wstorage(!1,b(),{at:g,tracker_status:n.tracker_status,updated_at:now_sec()});k||(k=setTimeout(e,5E3))}function e(){k=null;p&&d()}function h(){m(0)||v()}function m(a){var e=c(wstorage(!1,b()));0<a&&(e.expired||e.owned)&&d();if(!a)return clearTimeout(f),f=null,e.same&&(f=setTimeout(h,5E3)),!!e.same;0>a&&e.owned&&wstorage(!1,b(),null)}var g,f,k;if(!wstorage())return function(){return!1};a(window).on("storage",function(a){a=a.originalEvent;n&&n.tracker_site&&
a.key==b()&&(a=c(a.newValue),(a.expired||a.fresh)&&v())});return m}();a(window).on("unload",function(){K(-1)});return{init:function(a){h(a,!0)},tracker_ui:f,tracker_show_elapsed:g}}(jQuery);var hotcrp_load={time:setLocalTime.initialize};function input_is_checkboxlike(a){return"checkbox"===a.type||"radio"===a.type}
function input_default_value(a){return input_is_checkboxlike(a)?a.hasAttribute("data-default-checked")?!!a.getAttribute("data-default-checked"):a.defaultChecked:a.hasAttribute("data-default-value")?a.getAttribute("data-default-value"):a.defaultValue}
function form_differs(a,b){var c=null,d=$(a).find("input, select, textarea");d.length||(d=$(a).filter("input, select, textarea"));d.each(function(){var a=$(this);if(a.hasClass("ignore-diff"))return!0;var b=input_default_value(this);input_is_checkboxlike(this)?this.checked!==b&&(c=this):(a="SELECT"===this.tagName?a.val():this.value,text_eq(a,b)||(c=this));return!c});return b?c:!!c}
function form_defaults(a,b){if(b)$(a).find("input, select, textarea").each(function(){input_is_checkboxlike(this)?this.setAttribute("data-default-checked",b[this.name]?"1":""):this.setAttribute("data-default-value",b[this.name]||"")});else return b={},$(a).find("input, select, textarea").each(function(){b[this.name]=input_default_value(this)}),b}function form_highlight(a,b){a instanceof HTMLElement||(a=$(a)[0]);toggleClass(a,"alert",b&&form_differs(b)||form_differs(a))}
function hiliter_children(a,b){a=$(a)[0];form_highlight(a);$(a).on("change input","input, select, textarea",function(){hasClass(this,"ignore-diff")||hasClass(a,"ignore-diff")||form_highlight(a,this)});b&&($(a).on("submit",function(){$(this).addClass("submitting")}),$(window).on("beforeunload",function(){if(hasClass(a,"alert")&&!hasClass(a,"submitting"))return"If you leave this page now, your edits may be lost."}))}
function focus_at(a){a.jquery&&(a=a[0]);a.focus();if(!a.hotcrp_ever_focused){if(a.select&&hasClass(a,"want-select"))a.select();else if(a.setSelectionRange)try{a.setSelectionRange(a.value.length,a.value.length)}catch(b){}a.hotcrp_ever_focused=!0}}function focus_within(a,b){a=$(a).find(".want-focus");b&&(a=a.filter(b));1==a.length&&focus_at(a[0]);return 1==a.length}
function refocus_within(a){var b=document.activeElement;if(b&&"A"!==b.tagName&&!$(b).is(":visible")){for(;b&&b!==a;)b=b.parentElement;b&&(a=$(a).find("input, select, textarea, a, button").filter(":visible").first(),a.length?a.focus():$(document.activeElement).blur())}}
function fold(a,b,c){var d;if(a&&($.isArray(a)||a.jquery)){for(d=0;d<a.length;d++)fold(a[d],b,c);return!1}"string"==typeof a&&(a=$$("fold"+a)||$$(a));if(!a)return!1;/^fold/.test(a.id||"")&&a.id.substr(4);d=c?c:"";var e="fold"+d+"o";var l="fold"+d+"c";d=0<=a.className.indexOf(e);if(null==b||!b!=d)if(a.className=d?a.className.replace(e,l):a.className.replace(l,e),(b=document.activeElement)&&hasClass(b,"keep-focus")||!d&&focus_within(a)||refocus_within(a),a=a.getAttribute("data-fold-session")){if("{"===
a.charAt(0)||"["===a.charAt(0))a=(JSON.parse(a)||{})[c];a&&$.post(hoturl_post("api/setsession",{v:a+(d?"=1":"=0")}))}return!1}
function foldup(a,b){var c=this,d,e;"number"===typeof b?b={n:b}:b||(b={});if(!("n"in b)&&(e=this.getAttribute("data-fold-target"))){var l=e.indexOf("#");0<l&&(c=$$(e.substring(0,l)),e=e.substring(l+1));b.n=parseInt(e)||0;"f"in b||(e=e.length?e.charAt(e.length-1):"","c"===e?b.f=!0:"o"===e&&(b.f=!1))}for(e="fold"+(b.n||"");!(!c||c.id&&"fold"==c.id.substr(0,4)||hasClass(c,"has-fold")||null!=b.n&&(hasClass(c,e+"c")||hasClass(c,e+"o")));)c=c.parentNode;if(!c)return!0;null==b.n&&(d=c.className.match(/\bfold(\d*)[oc]\b/))&&
(b.n=+d[1],e="fold"+(b.n||""));if(!("f"in b)&&"INPUT"===this.tagName)if("checkbox"===this.type)b.f=!this.checked;else if("radio"===this.type){if(!this.checked)return!0;d=(c.getAttribute("data-"+e+"-values")||"").split(/\s+/);b.f=0>d.indexOf(this.value)}d=!hasClass(c,e+"c");"f"in b&&!b.f===d||(b.f=d,fold(c,d,b.n||0),$(c).trigger("fold",b));this.hasAttribute("aria-expanded")&&this.setAttribute("aria-expanded",d?"false":"true");a&&"object"===typeof a&&"click"===a.type&&(a.stopPropagation(),a.preventDefault())}
handle_ui.on("js-foldup",foldup);$(document).on("fold",".js-fold-focus",function(a,b){focus_within(this,(b.f?".fn":".fx")+(b.n||"")+" *")});$(function(){$("input.uich.js-foldup").each(function(){foldup.call(this,null)})});handle_ui.on("js-aufoldup",function(a){var b=$$("foldpaper"),c=b.className.match(/\bfold9([co])\b/),d=b.className.match(/\bfold8([co])\b/);!c||d&&"o"!=d[1]||foldup.call(b,a,9);!d||c&&"c"!=d[1]&&"o"!=c[1]||(foldup.call(b,a,8),"o"==d[1]&&$$("foldpscollab")&&fold("pscollab",1))});
handle_ui.on("js-click-child",function(a){var b=$(this).find("a")[0];b&&a.target!==b&&(a=new MouseEvent("click",{button:a.button,buttons:a.buttons,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey}),b.dispatchEvent(a))});var push_history_state;
push_history_state="pushState"in window.history?function(a){if(!history.state){var b={href:location.href};$(document).trigger("collectState",[b]);history.replaceState(b,document.title,b.href)}a&&(b={href:a},$(document).trigger("collectState",[b]),history.pushState(b,document.title,b.href));return!1}:function(){return!0};
window.focus_fold=function(a){function b(b){var c=this,d;if(c.hasAttribute("data-fold-target"))return foldup.call(c,b),e=!0;for(;c;){if(hasClass(c,"linelink")){for(d=c.parentElement;d&&!hasClass(d,"linelinks");d=d.parentElement);if(!d)break;addClass(c,"active");a(d).find(".linelink").not(c).removeClass("active");b&&(focus_within(c,".lld *"),event_prevent(b));return e=!0}if(d=c.className.match(/\b(?:lll|lld|tll|tld)(\d+)/)){for(;c&&!/\b(?:tab|line)links\d/.test(c.className);)c=c.parentElement;if(!c)break;
c.className=c.className.replace(/links\d+/,"links"+d[1]);b&&(focus_within(c,".lld"+d[1]+" *, .tld"+d[1]+" *"),event_prevent(b));return e=!0}c=c.parentElement}return!1}function c(c){var d=c.match(/#.*/);d=d?d[0]:"";a("a.has-focus-history").each(function(){if(this.getAttribute("href")===d)return b.call(this),!1})}function d(a){b.call(this,a)&&this instanceof HTMLAnchorElement&&hasClass(this,"has-focus-history")&&push_history_state(this.href)}var e;a(window).on("popstate",function(a){(a=(a.originalEvent||
a).state)&&c(a.href)});d.hash=function(){e||c(location.href)};return d}($);handle_ui.on("tla",focus_fold);function make_link_callback(a){return function(){window.location=a.href}}$(document).on("focus","input.js-autosubmit",function(a){a=$(a.target);a.closest("form").data("autosubmitType",a.data("autosubmitType")||!1)});
$(document).on("keypress","input.js-autosubmit",function(a){if(!event_modkey(a)&&"Enter"===event_key(a)){var b=$(a.target).closest("form"),c=b.data("autosubmitType"),d=b[0]?b[0]["default"]:null;d&&c&&(b[0].defaultact.value=c,a.target.blur(),d.click());if(d||!c)a.stopPropagation(),event_prevent(a)}});handle_ui.on("js-submit-mark",function(a){$(this).closest("form").data("submitMark",a.target.value)});
(function(a){function b(a,b,c,d){var e="assrev"+a;a=e+"_"+b;e='<div class="assignment-ui-choice"><input type="radio" name="'+e+'" value="'+b+'" id="'+a+'" class="assignment-ui-radio';e=(b==d?e+' want-focus" checked':e+'"')+('>&nbsp;<label for="'+a+'">');0!=b&&(e+='<span class="rto rt'+b+'"><span class="rti">'+"C  E P 2 1 M".split(" ")[b+1]+"</span></span>&nbsp;");return(b==d?e+("<u>"+c+"</u>"):e+c)+"</label></div>"}function c(a,b,c){var d=c.closest(".has-assignment-set");try{var e=JSON.parse(d.attr("data-review-rounds")||
"[]")}catch(h){e=[]}var m="";if(1<e.length){b=(b=0<b?c[0].getAttribute("data-review-round"):d[0].getAttribute("data-default-review-round"))||"unnamed";m+='<div class="assignment-ui-round fx2">Round:&nbsp; <select name="rev_round'+a+'" data-default-value="'+b+'">';for(a=0;a<e.length;++a)m+='<option value="'+e[a]+'"',e[a]==b&&(m+=" selected"),m+=">"+e[a]+"</option>";m+="</select></div>"}return m}function d(b){b=a(b.target).closest(".has-assignment");var c=b.closest(".has-assignment-set"),d=c.data("lastAssignmentModified");
d&&d!==b[0]&&!form_differs(a(d))&&(a(d).find(".has-assignment-ui").remove(),a(d).addClass("foldc").removeClass("foldo"));c.data("lastAssignmentModified",b[0]);this.checked&&(b=a(this).closest(".has-assignment-ui"),fold(b[0],0>=this.value,2))}handle_ui.on("js-assignment-fold",function(e){var l=a(e.target).closest(".has-assignment"),k=l.find(".has-assignment-ui");if(l.hasClass("foldc")){var g=l.closest(".has-assignment-set");g.hasClass("need-assignment-change")&&g.on("change","input.assignment-ui-radio",
d).removeClass("need-assignment-change");if(!k.length){k=l.attr("data-pid")+"u"+l.attr("data-uid");g=+l.attr("data-review-type");var f=+l.attr("data-conflict-type"),m=l[0].hasAttribute("data-review-in-progress");k=a('<div class="has-assignment-ui fold2'+(0<g?"o":"c")+'"><div class="assignment-ui-options">'+b(k,4,"Primary",g)+b(k,3,"Secondary",g)+b(k,2,"Optional",g)+b(k,5,"Metareview",g)+(m?"":b(k,-1,"Conflict",0<f?-1:0)+b(k,0,"None",g||f?-1:0))+"</div>"+c(k,g,l)+"</div>").appendTo(l)}l.addClass("foldo").removeClass("foldc");
focus_within(k[0])}else form_differs(l)||(k.remove(),form_highlight(l.closest("form")[0]),l.addClass("foldc").removeClass("foldo"));e.stopPropagation()})})($);
function revreq_email_input(a){function b(a){a&&a.ok||(a={});if(d.email.value.trim()===c||d.getAttribute("data-showing-email")!==c)d.firstName.setAttribute("placeholder",a.firstName||""),d.lastName.setAttribute("placeholder",a.lastName||""),d.affiliation.setAttribute("placeholder",a.affiliation||""),d.setAttribute("data-showing-email",c)}var c=this.value.trim(),d=$(this).closest("form")[0];/^\S+@\S+\.\S\S+$/.test(c)?$.ajax(hoturl_post("api/user",{email:c}),{method:"GET",success:b}):b(null)}
var row_order_ui=function(a){function b(b,c,l){function d(b){b=a(b).find("input, select, textarea");var c;for(c=0;c!=b.length;++c){var d=a(b[c]),e=d.val();if(""!=e&&e!==d.attr("placeholder"))return!0}return!1}if(0<l)b=a(b);else{var e=a(b).closest("tr");b=e.closest("tbody")}var f=+b.attr("data-max-rows")||0,m=Math.max(+b.attr("data-min-rows")||0,1),h=b.attr("data-row-order-autogrow");if(0>l)e.remove(),c=0;else if(0==l){for(e=e[0];0>c&&e.previousSibling;++c)a(e).insertBefore(e.previousSibling);for(;0<
c&&e.nextSibling;--c)a(e).insertAfter(e.nextSibling)}c=b.children();c.length>m&&0>l&&!d(c[c.length-1])&&(a(c[c.length-1]).remove(),c=b.children());for(e=0<l;(c.length<m||h&&d(c[c.length-1])||0<l)&&(0>=f||c.length<f);){var r=a(b[0].getAttribute("data-row-template")).appendTo(b);mktemptext(r);suggest(r.find(".papersearch"),taghelp_q);c=b.children();e&&(focus_within(r),e=!1);--l}for(var v=1;v<=c.length;++v)l=a(c[v-1]),b=a(l[0].firstChild).html(),b!==v+"."&&/^(?:\d+|\$).$/.test(b)&&a(l[0].firstChild).html(v+
"."),l.find("input, select, textarea").each(function(){var a=/^(.*?)(?:\d+|\$)$/.exec(this.getAttribute("name"));a&&a[2]!=v&&this.setAttribute("name",a[1]+v)})}function c(c){hasClass(this,"moveup")?b(this,-1,0):hasClass(this,"movedown")?b(this,1,0):hasClass(this,"delete")?b(this,0,-1):hasClass(this,"addrow")&&(c=a(this).closest(".js-row-order").children().filter("[data-row-template]"),c.length&&b(c[0],0,1))}handle_ui.on("row-order-ui",c);c.autogrow=function(c){c=c||a(this);if(!c.attr("data-row-order-autogrow"))c.attr("data-row-order-autogrow",
!0).removeClass("need-row-order-autogrow").on("input change","input, select, textarea",function(){b(this,0,0)})};a(function(){a(".need-row-order-autogrow").each(c.autogrow)});return c}($);
function make_outline_flasher(a,b,c){var d=a.hotcrp_outline_flasher;d||(d=a.hotcrp_outline_flasher={old_outline:a.style.outline});d.interval&&(clearInterval(d.interval),d.interval=null);if(b){c=c||3E3;var e=.6*c;d.start=now_msec();d.interval=setInterval(function(){var l=now_msec()-d.start,k=0;l<e?k=.5:l<=c&&(k=.5*Math.cos((l-e)/(c-e)*Math.PI));.03>=k?(a.style.outline=d.old_outline,clearInterval(d.interval),d.interval=null):assign_style_property(a,"outline","4px solid rgba("+b+", "+k+")")},13)}}
function setajaxcheck(a,b){"string"==typeof a&&(a=$$(a));if(a){if(a.jquery&&b&&!b.ok&&b.errf){var c,d,e=a.closest("form");for(c in b.errf)if((d=e.find("[name='"+c+"']")).length){a=d[0];break}}a.jquery&&(a=a[0]);make_outline_flasher(a);!b||b.ok||b.error||(b={error:"Error"});!b||b.ok?make_outline_flasher(a,"0, 200, 0"):a.style.outline="5px solid red";b&&b.error&&make_bubble(b.error,"errorbubble").near(a).removeOn(a,"input change click hide")}}
function link_urls(a){return a.replace(/((?:https?|ftp):\/\/(?:[^\s<>"&]|&amp;)*[^\s<>"().,:;&])(["().,:;]*)(?=[\s<>&]|$)/g,function(a,c,d){return'<a href="'+c+'" rel="noreferrer">'+c+"</a>"+d})}function HtmlCollector(){this.clear()}HtmlCollector.prototype.push=function(a,b){if(a&&b)return this.open.push(this.html+a),this.close.push(b),this.html="",this.open.length-1;this.html+=a;return this};
HtmlCollector.prototype.pop=function(a){for(null==a&&(a=Math.max(0,this.open.length-1));this.open.length>a;)this.html=this.open[this.open.length-1]+this.html+this.close[this.open.length-1],this.open.pop(),this.close.pop();return this};HtmlCollector.prototype.pop_n=function(a){this.pop(Math.max(0,this.open.length-a));return this};HtmlCollector.prototype.push_pop=function(a){this.html+=a;return this.pop()};HtmlCollector.prototype.pop_push=function(a,b){this.pop();return this.push(a,b)};
HtmlCollector.prototype.pop_collapse=function(a){for(null==a&&(a=this.open.length?this.open.length-1:0);this.open.length>a;)""!==this.html&&(this.html=this.open[this.open.length-1]+this.html+this.close[this.open.length-1]),this.open.pop(),this.close.pop();return this};HtmlCollector.prototype.render=function(){this.pop(0);return this.html};HtmlCollector.prototype.clear=function(){this.open=[];this.close=[];this.html="";return this};
HtmlCollector.prototype.next_htctl_id=function(){var a=1;return function(){for(;document.getElementById("htctl"+a);)++a;++a;return"htctl"+(a-1)}}();
window.render_text=function(a){function b(a){a=a.split(/((?:\r\n?|\n)(?:[-+*][ \t]|\d+\.)?)/);for(var b,c=1;c<a.length;c+=2)49<a[c-1].length&&2>=a[c].length&&""!==(b=a[c+1].charAt(0))&&" "!==b&&"\t"!==b&&(a[c]=" ");a="<p>"+link_urls(escape_entities(a.join("")))+"</p>";return a.replace(/\r\n?(?:\r\n?)+|\n\n+/g,"</p><p>")}function c(a){var b,c;if(a&&(b=f[a])||a&&"string"===typeof a&&0<(c=a.indexOf("."))&&(b=f[a.substring(0,c)]))return b;null==a&&(a=g);return f[a]||f[0]}function d(a,d,e){a=c(a);if(a.format)try{return{format:a.formatClass||
a.format,content:(d&&a.render_inline||a.render).apply(this,e)}}catch(v){log_jserror("do_render format "+a.format+": "+v.toString(),v)}return{format:0,content:b(e[0])}}function e(a,b){var c=[b],e;for(e=2;e<arguments.length;++e)c.push(arguments[e]);return d.call(this,a,!1,c)}function l(a,b){var c=[b],e;for(e=2;e<arguments.length;++e)c.push(arguments[e]);return d.call(this,a,!0,c)}function k(){var b=a(this),c=this.getAttribute("data-format"),d=this.getAttribute("data-content")||b.text(),g=null,f;if(0<
c.indexOf(".")){var k=c.split(/\./);c=k[0];g={};for(f=1;f<k.length;++f)g[k[f]]=!0}c="DIV"==this.tagName?e.call(this,c,d,g):l.call(this,c,d,g);d=a.trim(this.className.replace(/(?:^| )(?:need-format|format\d+)(?= |$)/g," "));this.className=d+(d?" format":"format")+(c.format||0);b.html(c.content).trigger("renderText",c)}var g=0,f={0:{format:0,render:b}};a.extend(e,{add_format:function(a){a.format&&(f[a.format]=a)},format:function(a){return c(a)},set_default_format:function(a){g=a},inline:l,on:k,on_page:function(){a(".need-format").each(k)}});
return e}($);$(function(){function a(){var a=$("#foldpaper").hasClass("fold6c");if(a){var c=$(".abstract");c.length&&c.height()>c.closest(".paperinfo-abstract").height()-c.position().top&&(a=!1)}$("#foldpaper").toggleClass("fold7c",a)}$(".paperinfo-abstract").length&&(a(),$("#foldpaper").on("fold renderText",a),$(window).on("resize",a))});
window.review_form=function(a){function b(b){var c=a.grep(k,function(a){return a.options&&a.allow_empty?a.uid in b:!!b[a.uid]}),d="",e,g=0;for(e=0;e!=c.length;++e){var f=c[e];var l=c[e+1];1!=g&&f.options&&l&&l.options?(g=1,d+='<div class="rvg">'):g=1==g?2:0;d+='<div class="rv rv'+"glr".charAt(g)+'" data-rf="'+f.uid+'"><div class="revvt"><div class="revfn">'+f.name_html;l=f.visibility;"audec"==l&&hotcrp_status&&hotcrp_status.myperm&&hotcrp_status.myperm.some_author_can_view_decision&&(l="au");"au"!=
l&&(d+='<div class="revvis">('+({secret:"secret",admin:"shown only to chairs",pc:"hidden from authors",audec:"hidden from authors until decision"}[l]||l)+")</div>");d+='</div></div><div class="revv revv'+"glr".charAt(g);f.options?d=b[f.uid]&&(l=f.score_info.parse(b[f.uid]))?d+('"><table><tr><td class="nw">'+f.score_info.unparse_revnum(l)+"&nbsp;</td><td>"+escape_entities(f.options[l-1])+"</td></tr></table>"):d+(' rev_unknown">'+(f.allow_empty?"No entry":"Unknown")):(l=render_text(b.format,b[f.uid],
f.uid),d+=" revtext format"+(l.format||0)+'">'+l.content);d+="</div></div>";2==g&&(d+="</div>")}return d}function c(a){for(var b=[0,0,0,0,0,0,0],c=0;c<a.length;++c)for(var d=0;a[c]>=1<<d;++d)b[d]+=a[c]&1<<d?1:0;return b}function d(a,b,d){if(!d&&!a.length)return"";var e=c(a),g="Good review;Needs work;Too short;Too vague;Too narrow;Not constructive;Not correct".split(";"),f=[];f.push('<span class="revrating-group flag fn">'+(d?'<a href="" class="qq ui js-revrating-unfold">':'<a href="'+hoturl("help",
{t:"revrate"})+'" class="qq">')+"&#x2691;</a></span>");for(var h=0;h<g.length;++h)if(d){var m="revrating-choice",k="";!e[h]&&(2<=h||a.length)&&(m+=" fx");e[h]||(m+=" revrating-unused");b&&b&1<<h&&(m+=" revrating-active");(b?(b&(1<<h+1)-1)!==1<<h:h)||(k+=" want-focus");f.push('<span class="'+m+'" data-revrating-bit="'+h+'"><button class="ui js-revrating'+k+'">'+g[h]+'</button><span class="ct">'+(e[h]?" "+e[h]:"")+"</span></span>")}else e[h]&&f.push('<span class="revrating-group">'+g[h]+'<span class="ct"> '+
e[h]+"</span></span>");return d?(f.push('<span class="revrating-group fn"><button class="ui js-foldup">\u2026</button></span>'),'<div class="revrating editable has-fold foldc ui js-revrating-unfold'+(2===b?" want-revrating-generalize":"")+'"><div class="f-c fx"><a href="'+hoturl("help",{t:"revrate"})+'" class="qq">Review ratings <span class="n">(anonymous reviewer feedback)</span></a></div>'+f.join(" ")+"</div>"):f?'<div class="revrating">'+f.join(" ")+"</div>":""}function e(b){var c=event_key(b);
if(("ArrowLeft"===c||"ArrowRight"===c)&&!event_modkey(b)){foldup.call(this,null,{f:!1});var d=a(this).closest(".revrating-choice").attr("data-revrating-bit");null!=d&&("ArrowLeft"===c&&0<d?--d:"ArrowRight"===c&&6>d&&++d,a(this).closest(".revrating").find(".revrating-choice").each(function(){this.getAttribute("data-revrating-bit")==d&&this.firstChild.focus()}));b.preventDefault()}}var l,k,g={"-3":["\u2212","Refused"],"-2":["A","Author"],"-1":["C","Conflict"],1:["E","External review"],2:["P","PC review"],
3:["2","Secondary review"],4:["1","Primary review"],5:["M","Metareview"]};tooltip.add_builder("rf-score",function(b){var c=a(this),d=l[c.data("rf")],e;d&&d.score_info&&(e=d.score_info.parse(c.find("span.sv").text()))&&(b=a.extend({content:d.options[e-1],dir:"l",near:c.find("span")[0]},b));return b});tooltip.add_builder("rf-description",function(b){var c=a(this).closest(".rv");if(c.length&&(c=l[c.data("rf")])&&(c.description||c.options)){var d="",e;c.description&&(d=/<(?:p|div|table)/i.test(c.description)?
d+c.description:d+("<p>"+c.description+"</p>"));if(c.options){d+='<div class="od">Choices are:</div>';var g=0;for(e=c.score_info.value_order();g<e.length;++g)d+='<div class="od"><span class="rev_num '+c.score_info.className(e[g])+'">'+c.score_info.unparse(e[g])+".</span>&nbsp;"+escape_entities(c.options[e[g]-1])+"</div>"}b=a.extend({content:d,dir:"l"},b)}return b});handle_ui.on("js-revrating-unfold",function(a){a.target===this&&foldup.call(this,null,{f:!1})});handle_ui.on("js-revrating",function(){var b=
0,d=0,e=0,g=a(this).closest(".revrating");g.find(".revrating-choice").each(function(){hasClass(this,"revrating-active")&&(e|=1<<this.getAttribute("data-revrating-bit"))});var k=this.parentNode;hasClass(k,"revrating-active")?b=1<<k.getAttribute("data-revrating-bit"):(d=1<<k.getAttribute("data-revrating-bit"),b=1===d?126:1,4<=d&&g.hasClass("want-revrating-generalize")&&(b|=2));1>=e&&2===d?g.addClass("want-revrating-generalize"):g.removeClass("want-revrating-generalize");2===d&&(g.find(".want-focus").removeClass("want-focus"),
addClass(k,"want-focus"),fold(g[0],!1));k=a(this).closest(".revcard");a.post(hoturl_post("api",{p:k.attr("data-pid"),r:k.data("rid"),fn:"reviewrating"}),{user_rating:e&~b|d},function(a,b,d){a&&"user_rating"in a&&g.find(".revrating-choice").each(function(){var b=this.getAttribute("data-revrating-bit");toggleClass(this,"revrating-active",a.user_rating&1<<b);2>b&&2>=a.user_rating&&removeClass(this,"fx")});if(a&&"ratings"in a){var e=c(a.ratings);g.find(".revrating-choice").each(function(){var a=this.getAttribute("data-revrating-bit");
e[a]?(this.lastChild.innerText=" "+e[a],removeClass(this,"fx"),removeClass(this,"revrating-unused")):(this.lastChild.innerText="",2<=a&&addClass(this,"fx"),addClass(this,"revrating-unused"))})}})});return{set_form:function(b){var c;l=a.extend(l||{},b);for(c in l)b=l[c],b.uid=c,b.name_html=escape_entities(b.name),b.options&&(b.score_info=make_score_info(b.options.length,b.option_letter,b.option_class_prefix));k=a.map(l,function(a){return a});k.sort(function(a,b){return a.position-b.position})},add_review:function(c){var m=
new HtmlCollector,h=c.ordinal?c.pid+""+c.ordinal:""+c.rid,k="r="+h+(hotcrp_want_override_conflict?"&forceShow=1":"");m.push('<div class="revcard" id="r'+h+'" data-pid="'+c.pid+'" data-rid="'+c.rid+(c.ordinal?'" data-review-ordinal="'+c.ordinal:"")+'">',"</div>");m.push('<div class="revcard_head">',"</div>");c.editable&&m.push('<div class="floatright"><a class="xx" href="'+hoturl_html("review",k)+'"><img class="b" src="'+assetsurl+'images/edit48.png" alt="[Edit]" width="16" height="16">&nbsp;<u>Edit</u></a></div>');
m.push('<h3><a class="u" href="'+hoturl_html("review",k)+'">Review'+(c.ordinal?"&nbsp;#"+h:"")+"</a></h3>");h=[];k="";c.rtype&&(k=' &nbsp;<span class="rto rt'+c.rtype+(c.submitted?"":"n")+'" title="'+g[c.rtype][1]+'"><span class="rti">'+g[c.rtype][0]+"</span></span>",c.round&&(k+='&nbsp;<span class="revround">'+escape_entities(c.round)+"</span>"));c.review_token?h.push("Review token "+c.review_token+k):c.reviewer&&c.blind?h.push("["+c.reviewer+"]"+k):c.reviewer?h.push(c.reviewer+k):k&&h.push(k.substr(7));
c.modified_at&&h.push("Updated "+c.modified_at_text);h.length&&m.push(' <span class="revinfo">'+h.join(' <span class="barsep">\u00b7</span> ')+"</span>");c.message_html&&m.push('<div class="hint">'+c.message_html+"</div>");m.push_pop('<hr class="c">');m.push('<div class="revcard_body">',"</div>");m.push_pop(b(c));h="user_rating"in c;if(c.ratings&&c.ratings.length||h)m.push('<div class="revcard_rating">',"</div>"),m.push(d(c.ratings||[],c.user_rating||0,h));c=a(m.render()).appendTo(a("#body"));if(h)c.find(".revrating.editable").on("keydown",
"button.js-revrating",e);c.find(".rv .revfn").attr("data-tooltip-info","rf-description").each(tooltip)}}}($);
window.papercomment=function(a){function b(b){var c=a(b).closest(".cmtg");c.length||(c=a(b).closest(".cmtcard").find(".cmtg"));c.c=C[c.closest(".cmtid")[0].id];return c}function c(a){return a.response?(1==a.response?"":a.response)+"response":a.is_new?"cnew":"c"+(a.ordinal||"x"+a.cid)}function d(a){var b=hotcrp_status.myperm;return a.response?b.can_responds&&!0===b.can_responds[a.response]:!0===b.can_comment}function e(){var b=a(this).closest(".cmteditinfo"),c="au"!=b.find("select[name=visibility]").val();
fold(b[0],c,2)}function l(a,b){function c(a){a=count_words(this.value);d.className="words"+(b<a?" wordsover":.9*b<a?" wordsclose":"");d.innerHTML=b<a?plural(a-b,"word")+" over":plural(b-a,"word")+" left"}var d=a.find(".words")[0];d&&a.find("textarea").on("input",c).each(c)}function k(a,b){var c=new HtmlCollector;c.push('<div class="has-document compact" data-document-name="cmtdoc_'+b.docid+"_"+a+'">',"</div>");c.push('<div class="document-file">',"</div>");g(c,b);c.pop();c.push('<div class="document-actions"><a class="ui js-remove-document document-action" href="">Delete</a></div>');
return c.render()}function g(a,b){a.push('<a href="'+text_to_html(siteurl+b.siteurl)+'" class="q">',"</a>");"application/pdf"===b.mimetype?a.push('<img src="'+assetsurl+'images/pdf.png" alt="[PDF]" class="sdlimg">'):a.push('<img src="'+assetsurl+'images/generic.png" alt="[Attachment]" class="sdlimg">');a.push("\u00a0"+text_to_html(b.filename||"Attachment"));null!=b.size&&(a.push(' <span class="dlsize">(',"kB)</span>"),921<b.size?a.push(Math.round(b.size/1024)):0<b.size?a.push(Math.round(b.size/102.4)/
10):a.push("0"),a.pop());a.pop()}function f(){var c,d=a(".cmtg textarea[name=comment]");for(c=0;c!=d.length&&u;++c){var e=b(d[c]);var g=a(d[c]).val().replace(/\s+$/,"");if(!text_eq(g,e.c&&e.c.text||""))return"If you leave this page now, your edits will be lost."}}function m(e,g,h){function k(b,e,g){if(b.ok)if(e=c(f.c),g=f.c.response&&d(f.c),b.cmt||f.c.is_new||delete C[e],!b.cmt&&g&&(b.cmt={is_new:!0,response:f.c.response,editable:!0,draft:!0,cid:e}),b.cmt){var h=c(b.cmt);e!==h&&(f.closest(".cmtid")[0].id=
h,delete C[e],E&&papercomment.add(E));n(f,b.cmt,g,b.msg)}else f.closest(".cmtg").html(b.msg);else b.loggedout&&(u=!1,l[0].method="post",l[0].action=hoturl_post("paper",a.extend({editcomment:1},r)),l[0].submit()),f.find(".cmtmsg").html(b.error?render_xmsg(2,b.error):b.msg),f.find("button").prop("disabled",!1)}var f=b(e),l=f.find("form");if(d(f.c)||h){l.find("input[name=draft]").remove();"savedraft"===g&&l.children("div").append('<input type="hidden" name="draft" value="1">');var r={p:hotcrp_paperid};
f.c.cid&&(r.c=f.c.cid);var p=a.extend({ajax:1},r);h&&(p.override=1);hotcrp_want_override_conflict&&(p.forceShow=1);"delete"===g?p.deletecomment=1:p.submitcomment=1;h=hoturl_post("comment",p);f.find("button").prop("disabled",!0);window.FormData?a.ajax(h,{method:"POST",data:new FormData(l[0]),success:k,processData:!1,contentType:!1}):a.post(h,l.serialize(),k)}else override_deadlines.call(e,function(){m(e,g,!0)})}function h(a){"Enter"===event_key(a)&&event_modkey(a)===event_modkey.META&&(a.preventDefault(),
m(this,"submit"))}function r(a){var c=this,d=b(this);"bsubmit"===this.name?(a.preventDefault(),m(this,"submit")):"savedraft"===this.name?m(this,this.name):"cancel"===this.name?n(d,d.c,!1):"delete"===this.name?override_deadlines.call(this,function(){m(c,c.name)}):"showtags"===this.name&&(fold(d.find(".cmteditinfo")[0],!1,3),d.find("input[name=commenttags]").focus())}function v(a){a.preventDefault();m(this,"submit")}function n(b,f,m,n){var p=new HtmlCollector;new HtmlCollector;C[c(f)]=f;if(f.response){var B=
b.closest(".cmtcard").find(".cmtcard_head");B.find(".cmtinfo").remove()}var t=[];f.visibility&&!f.response&&t.push("cmt"+f.visibility+"vis");f.color_classes&&(make_pattern_fill(f.color_classes),t.push("cmtcolor "+f.color_classes));t.length&&p.push('<div class="'+t.join(" ")+'">',"</div>");p.push('<div class="cmtt">',"</div>");f.is_new&&!m?(p.push('<h3><a class="q ui fn cmteditor" href="">+&nbsp;',"</a></h3>"),f.response?p.push_pop("1"==f.response?"Add Response":"Add "+f.response+" Response"):p.push_pop("Add Comment")):
f.is_new&&!f.response?p.push("<h3>Add Comment</h3>"):f.editable&&!m&&(t='<div class="cmtinfo floatright"><a class="xx ui editor cmteditor" href=""><u>Edit</u></a></div>',f.response?a(t).prependTo(B):p.push(t));t=[];var x;f.ordinal&&t.push('<div class="cmtnumhead"><a class="qq" href="#'+c(f)+'"><span class="cmtnumat">@</span><span class="cmtnumnum">'+f.ordinal+"</span></a></div>");if(f.author&&f.author_hidden)t.push('<div id="foldcid'+f.cid+'" class="cmtname fold4c"><a class="ui q js-foldup" href="#" data-fold-target="4" title="Toggle author"><span class="fn4">+&nbsp;<i>Hidden for blind review</i></span><span class="fx4">[blind]</span></a><span class="fx4">&nbsp;'+
f.author+"</span></div>");else if(f.author){var u=f.author;f.blind&&"au"===f.visibility&&(u="["+u+"]");f.author_pseudonym&&(u=f.author_pseudonym+" \u00a0"+u);t.push('<div class="cmtname">'+u+"</div>")}else f.author_pseudonym&&t.push('<div class="cmtname">'+f.author_pseudonym+"</div>");f.modified_at&&t.push('<div class="cmttime">'+f.modified_at_text+"</div>");if(!f.response&&f.tags){u=[];for(x in f.tags){var L=f.tags[x].replace(z,"~");u.push('<a class="qq" href="'+hoturl_html("search",{q:"cmt:#"+L})+
'">#'+L+"</a>")}t.push('<div class="cmttags">'+u.join(" ")+"</div>")}!f.response&&(x=H[f.visibility])&&t.push('<div class="cmtvis">('+x+")</div>");t=t.join("");f.response?(B.find(".cmtthead").remove(),B.append('<div class="cmtthead">'+t+"</div>")):p.push(t);p.pop_collapse();p.push('<div class="cmtv">',"</div>");p.push('<div class="cmtmsg">',"</div>");n?p.push(n):f.response&&f.draft&&f.text&&p.push('<div class="msg msg-warning">This is a draft response. Reviewers won\u2019t see it until you submit.</div>');
p.pop();if(m){n=[];x=[];t=c(f);u=[];f.response&&A[f.response].instrux&&u.push(A[f.response].instrux);f.response&&!hotcrp_status.myperm.act_author?u.push("You aren\u2019t a contact for this paper, but as an administrator you can edit the authors\u2019 response."):f.review_token&&hotcrp_status.myperm.review_tokens&&0<=hotcrp_status.myperm.review_tokens.indexOf(f.review_token)?u.push("You have a review token for this paper, so your comment will be anonymous."):!f.response&&f.author_email&&hotcrp_user.email&&
f.author_email.toLowerCase()!=hotcrp_user.email.toLowerCase()&&u.push(hotcrp_status.myperm.act_author?"You didn\u2019t write this comment, but you can edit it as a fellow author.":"You didn\u2019t write this comment, but you can edit it as an administrator.");u.length&&p.push(render_xmsg(0,u));p.push('<form><div style="font-weight:normal;font-style:normal">',"</div></form>");f.review_token&&p.push('<input type="hidden" name="review_token" value="'+escape_entities(f.review_token)+'">');p.push('<div class="f-i">',
"</div>");u=render_text.format(f.format);L=u.description||"";u.has_preview&&(L+=(L?' <span class="barsep">\u00b7</span> ':"")+'<a href="" class="ui js-togglepreview" data-format="'+(u.format||0)+'">Preview</a>');L&&p.push('<div class="formatdescription">'+L+"</div>");p.push_pop('<textarea name="comment" class="reviewtext cmttext c" rows="5" cols="60" placeholder="Leave a comment"></textarea>');p.push('<div class="cmteditinfo fold2o fold3c">',"</div>");f.response||f.by_author||(hotcrp_status.myperm.some_author_can_view_review?
(u="Visible to authors",L="Authors will be notified immediately."):(u="Eventually visible to authors",L="Authors cannot view comments at the moment."),!0===hotcrp_status.rev.blind&&(u+=" (anonymous to authors)"),p.push('<div class="entryi short"><label for="'+t+'-visibility">Visibility</label>',"</div>"),p.push('<select id="'+t+'-visibility" name="visibility">',"</select>"),p.push('<option value="au">'+u+"</option>"),p.push('<option value="rev">Hidden from authors</option>'),p.push('<option value="pc">Hidden from authors and external reviewers</option>'),
p.push_pop('<option value="admin">Administrators only</option>'),p.push('<div class="fx2">',"</div>"),hotcrp_status.rev.blind&&!0!==hotcrp_status.rev.blind&&p.push('<div class="checki"><label><span class="checkc"><input type="checkbox" name="blind" value="1">&nbsp;</span>Anonymous to authors</label></div>'),p.push('<p class="f-h">',"</p>"),p.push_pop(L),p.pop_n(2));p.push('<div class="entryi has-editable-attachments hidden" id="'+t+'-attachments" data-document-prefix="cmtdoc"><label for="'+t+'-attachments">Attachments</label></div>');
x.push('<button type="button" name="attach" class="btn btn-licon need-tooltip ui js-add-attachment" aria-label="Attach file" data-editable-attachments="'+t+'-attachments">'+a("#licon-attachment").html()+"</button>");f.response||f.by_author||(p.push('<div class="entryi fx3"><label for="'+t+'-tags">Tags</label>',"</div>"),p.push_pop('<input id="'+t+'-tags" name="commenttags" type="text" size="50">'),x.push('<button type="button" name="showtags" class="btn btn-licon need-tooltip" aria-label="Tags">'+
a("#licon-tag").html()+"</button>"));f.is_new||(t=f.response?"response":"comment",x.push('<button type="button" name="delete" class="btn btn-licon need-tooltip" aria-label="Delete '+t+'" data-override-text="Are you sure you want to delete this '+t+'?">'+a("#licon-trash").html()+"</button>"));p.pop();t=d(f)?"":'<div class="hint">(admin only)</div>';f.response?(n.push('<button type="button" name="bsubmit" class="btn btn-primary">Submit</button>'+t),f.response&&(p.push('<input type="hidden" name="response" value="'+
f.response+'">'),(f.is_new||f.draft)&&n.push('<button type="button" name="savedraft" class="btn">Save draft</button>'+t))):n.push('<button type="button" name="bsubmit" class="btn btn-primary">Save</button>'+t);n.push('<button type="button" name="cancel" class="btn">Cancel</button>');x.length&&n.push('<div class="btnbox">'+x.join("")+"</div>");f.response&&0<A[f.response].words&&n.push("",'<div class="words"></div>');p.push('<div class="reviewtext aabig aab aabr">',"</div>");for(x=0;x<n.length;++x)""!==
n[x]&&p.push('<div class="aabut'+(""===n[x+1]?" aabutsp":"")+'">'+n[x]+"</div>");p.pop()}else if(p.push('<div class="cmttext"></div>'),f.docs&&f.docs.length){p.push('<div class="cmtattachments">',"</div>");for(n=0;n!=f.docs.length;++n)g(p,f.docs[n]);p.pop()}b.find("textarea, input[type=text]").unautogrow();b.html(p.render());if(m){m=[];var N;b.find("textarea[name=comment]").text(f.text||"").on("keydown",h).on("hotcrp_renderPreview",y).autogrow();p=f.visibility||hotcrp_status.myperm.default_comment_visibility||
"rev";b.find("select[name=visibility]").val(p).attr("data-default-value",p).on("change",e).change();for(N in f.tags||[])m.push(f.tags[N].replace(z,"~"));m.length&&fold(b.find(".cmteditinfo")[0],!1,3);b.find("input[name=commenttags]").val(m.join(" ")).autogrow();for(N in f.docs||[])b.find(".has-editable-attachments").removeClass("hidden").append(k(N,f.docs[N]));f.visiblity&&!f.blind||b.find("input[name=blind]").prop("checked",!0);f.response&&0<A[f.response].words&&l(b,A[f.response].words);f=b.find("form");
f.on("submit",v).on("click","button",r);hiliter_children(f);b.find(".need-tooltip").each(tooltip)}else(f.response?B.parent():b).find("a.cmteditor").click(D),w(f.format,f.text||"",f.response,b.find(".cmttext"),B);return b}function w(a,b,c,d,e){var f=render_text(a,b),g,h="format"+(f.format||0);d.addClass(h);c&&A[c]&&0<(g=A[c].words)&&(c=count_words(b),e&&e.append('<div class="cmtthead words">'+plural(c,"word")+"</div>"),c>g&&(e&&e.find(".words").addClass("wordsover"),c=count_words_split(b,g),d.addClass("has-overlong").removeClass(h).prepend('<div class="overlong-mark"><div class="overlong-allowed '+
h+'"></div></div><div class="overlong-content '+h+'"></div>'),d.find(".overlong-allowed").html(render_text(a,c[0]).content),d=d.find(".overlong-content")));d.html(f.content)}function y(c,d,e,f){c=b(a(c.target));w(d,e,c.c?c.c.response:0,a(f),null);return!1}function t(b,d){var e=c(b),f=a("#"+e),g=null;if(!f.length){var h=a("#body").children().last();!h.hasClass("cmtcard")&&(g=a("#body > .cmtcard").last()).length&&(b.is_new||g.append('<div class="cmtcard_link"><a class="qq" href="#'+e+'">Later comments &#x25BC;</a></div>'));
if(!h.hasClass("cmtcard")||b.response||h.hasClass("response"))h=a((b.response?'<div id="'+e+'" class="cmtcard cmtid response responseround_'+b.response+'"><div class="cmtcard_head"><h3>'+("1"==b.response?"Response":b.response+" Response")+"</h3></div>":'<div class="cmtcard">')+'<div class="cmtcard_body"></div></div>').appendTo("#body"),!b.response&&g&&g.length&&h.prepend('<div class="cmtcard_link"><a class="qq" href="#'+g.find("[id]").last().attr("id")+'">Earlier comments &#x25B2;</a></div>');f=b.response?
a('<div class="cmtg"></div>'):a('<div id="'+e+'" class="cmtg cmtid"></div>');f.appendTo(h.find(".cmtcard_body"))}null==d&&b.response&&b.draft&&b.editable&&(d=!0);E||"cnew"!==e||(E=b);n(f,b,d);return $$(e)}function D(){return B(b(this).c)}function B(d){var e=c(d),g=$$(e);!g&&d.response&&(g=t(d,!0));if(!g&&/\beditcomment\b/.test(window.location.search))return!1;g=b(g);g.find("textarea[name=comment]").length||n(g,d,!0);location.hash="#"+e;g.scrollIntoView();var h=g.find("textarea[name=comment]")[0];
h.setSelectionRange&&h.setSelectionRange(h.value.length,h.value.length);a(function(){h.focus()});u||a(window).on("beforeunload.papercomment",f);u=!0;return!1}var H={rev:"hidden from authors",pc:"hidden from authors and external reviewers",admin:"shown only to administrators"},C={},E,u=!1,A={};var z=hotcrp_user&&hotcrp_user.cid?new RegExp("^"+hotcrp_user.cid+"~"):/^~/;return{add:t,set_resp_round:function(a,b){A[a]=b},edit:B,edit_id:function(a){(a=C[a])&&B(a)}}}(jQuery);
(function(a){a(document).on("hotcrp_renderPreview",function(a,c,d,e){a=render_text(c,d);e.className="format"+(a.format||0);e.innerHTML=a.content});handle_ui.on("js-togglepreview",function(b){b=a(this).parent();for(var c;b.length&&0==(c=b.find("textarea")).length;)b=b.parent();c.length&&(c=c.first(),c.is(":visible")?(b=+this.getAttribute("data-format"),c.addClass("hidden"),c.after('<div class="preview"><div class="preview-border" style="margin-bottom:6px"></div><div></div><div class="preview-border" style="margin-top:6px"></div></div>'),
c.trigger("hotcrp_renderPreview",[b,c[0].value,c[0].nextSibling.firstChild.nextSibling]),this.innerHTML="Edit"):(c.next().remove(),c.removeClass("hidden"),c[0].focus(),this.innerHTML="Preview"));return!1})})($);
function quicklink_shortcut(a,b){var c=$$("quicklink_"+("j"==b?"prev":"next"));return c&&c.focus?(c.focus(),add_revpref_ajax.then(function(){c.click()}),!0):$$("quicklink_list")?(c=(c=a.target||a.srcElement)&&"INPUT"==c.tagName?c:$$("quicklink_list"),make_outline_flasher(c,"200, 0, 0",1E3),!0):!1}function comment_shortcut(){papercomment.edit_id("cnew");return!!$$("cnew")}
function nextprev_shortcut(a,b){var c=(location.hash||"#").replace(/^#/,""),d;a="n"==b?"nextSibling":"previousSibling";b="n"==b?"first":"last";c&&(d=$("#"+c)).length&&(d.hasClass("cmtcard")||d.hasClass("revcard")||d.hasClass("cmtg"))?(c=d[0],!c[a]&&d.hasClass("cmtg")&&(c=d.closest(".cmtcard")[0]),(c=c[a])&&!c.hasAttribute("id")&&$(c).hasClass("cmtcard")&&(c=$(c).find(".cmtg")[b]()[0])):(d=$(".cmtcard[id], .revcard[id], .cmtcard > .cmtcard_body > .cmtg[id]"),c=d[b]()[0]);c&&c.hasAttribute("id")&&(location.hash=
"#"+c.getAttribute("id"));return!0}function blur_keyup_shortcut(a){a=a||window.event;if(27!=(a.charCode||a.keyCode)||a.altKey||a.ctrlKey||a.metaKey)return!0;document.activeElement&&document.activeElement.blur();a.preventDefault?a.preventDefault():a.returnValue=!1;return!1}
function make_selector_shortcut(a){function b(a){return a.getElementsByTagName("select")[0]||a.getElementsByTagName("textarea")[0]||$(a).find("input[type=text]")[0]}function c(d){var e=$$("fold"+a);e.className=e.className.replace(/ psfocus\b/g,"");e=b(e);e.removeEventListener("blur",c,!1);e.removeEventListener("change",c,!1);d&&"change"==d.type&&this.blur();return!1}return function(d){var e=$$("fold"+a);if(e){e.className+=" psfocus";foldup.call(e,null,{f:!1});jQuery(e).scrollIntoView();if(e=b(e))focus_at(e),
e.addEventListener("blur",c,!1),e.addEventListener("change",c,!1);d.stopPropagation();return!0}return!1}}
function shortcut(a){function b(b){var c;b=b||window.event;var g=event_key(b);var h=b.target||b.srcElement;if(!g||b.altKey||b.ctrlKey||b.metaKey||h&&(c=h.tagName)&&h!=a&&("TEXTAREA"===c||"SELECT"===c||"INPUT"===c&&"button"!==h.type&&"checkbox"!==h.type&&"radio"!==h.type&&"reset"!==h.type&&"submit"!==h.type))return!0;h=now_msec();c=(e&&l&&600>=h-l?e:e=d)[g]||function(){return!1};if(jQuery.isFunction(c)){if(e=null,!c(b,g))return!0}else e=c,l=h;b.preventDefault?b.preventDefault():b.returnValue=!1;return!1}
function c(b,e){if(b){"string"===typeof b&&(b=[b]);for(var f=0,g=d;f<b.length-1;++f)g[b[f]]=g[b[f]]||{},jQuery.isFunction(g[b[f]])&&log_jserror("bad shortcut "+b.join(",")),g=g[b[f]];g[b[b.length-1]]=e}else c("j",quicklink_shortcut),c("k",quicklink_shortcut),a==document&&(c("c",comment_shortcut),c(["s","d"],make_selector_shortcut("decision")),c(["s","l"],make_selector_shortcut("lead")),c(["s","s"],make_selector_shortcut("shepherd")),c(["s","t"],make_selector_shortcut("tags")),c(["s","p"],make_selector_shortcut("revpref")),
c("n",nextprev_shortcut),c("p",nextprev_shortcut));return k}var d={},e=null,l=null;var k={add:c};a?"string"===typeof a&&(a=$$(a)):a=document;a&&!a.hotcrp_shortcut&&(a.addEventListener?a.addEventListener("keypress",b,!1):a.onkeypress=b,a.hotcrp_shortcut=!0);return k}function strnatcmp(a,b){var c=a.toLowerCase().replace(/"/g,"").localeCompare(b.toLowerCase().replace(/"/g,""));return 0!=c?c:a==b?0:a<b?-1:1}
var alltags=(new HPromise).onThen(function(a){hotcrp_user.is_pclike?jQuery.get(hoturl("api/alltags"),null,function(b){b=b&&b.tags||[];b.sort(strnatcmp);a.fulfill(b)}):a.fulfill([])});tooltip.add_builder("votereport",function(a){var b=$(this).attr("data-pid")||hotcrp_paperid,c=$(this).attr("data-tag");b&&c&&(a.content=(new HPromise).onThen(function(a){$.get(hoturl("api/votereport",{p:b,tag:c}),function(b){a.fulfill(b.ok?b.result||"":b.error)})}))});
var allmentions=(new HPromise).onThen(function(a){hotcrp_user.is_pclike?jQuery.get(hoturl("api/mentioncompletion",hotcrp_paperid?{p:hotcrp_paperid}:null),null,function(b){b=b&&b.mentioncompletion||[];b=b.map(completion_item);b.sort(function(a,b){return strnatcmp(a.s,b.s)});a.fulfill(b)}):a.fulfill([])});function completion_item(a){if("string"===typeof a)return{s:a};if($.isArray(a))return{s:a[0],description:a[1]};!("s"in a)&&"sm1"in a&&(a=$.extend({s:a.sm1,filter_length:1},a));return a}
var search_completion=(new HPromise).onThen(function(a){jQuery.get(hoturl("api/searchcompletion"),null,function(b){var c=b&&b.searchcompletion||[];b=$.grep(c,function(a){return"string"===typeof a});c=$.grep(c,function(a){return"object"===typeof a});var d=[];b.length&&c.push({pri:0,i:b});c.sort(function(a,b){return(a.pri||0)-(b.pri||0)});$.each(c,function(a,b){$.isArray(b.i)||(b.i=[b.i]);b.nosort||b.i.sort(function(a,b){a=completion_item(a);b=completion_item(b);return strnatcmp(a.s,b.s)});Array.prototype.push.apply(d,
b.i)});a.fulfill(d)})});function completion_split(a){return a.selectionStart==a.selectionEnd?[a.value.substring(0,a.selectionStart),a.value.substring(a.selectionEnd)]:null}function taghelp_tset(a,b){a=completion_split(a);var c;return a&&(c=a[0].match(/(?:^|\s)(#?)([^#\s]*)$/))?(a=a[1].match(/^([^#\s]*)((?:#[-+]?(?:\d+\.?|\.\d)\d*)?)/),alltags.then(make_suggestions(c[2],a[1],b,{suffix:a[2]}))):null}
function taghelp_q(a,b){a=completion_split(a);var c;return a&&(c=a[0].match(/.*?(?:^|[^\w:])((?:tag|r?order):\s*#?|#|(?:show|hide):\s*(?:#|tag:|tagvalue:))([^#\s()]*)$/))?(a=a[1].match(/^([^#\s()]*)/),alltags.then(make_suggestions(c[2],a[1],b))):a&&(c=a[0].match(/.*?(\b(?:has|ss|opt|dec|round|topic|style|color|show|hide):)([^"\s()]*|"[^"]*)$/))?(a=a[1].match(/^([^\s()]*)/),search_completion.then(make_suggestions(c[2],a[1],b,{prefix:c[1]}))):null}
function pc_tag_completion(a,b){a=completion_split(a);var c;return a&&(c=a[0].match(/(?:^|\s)(#?)([^#\s]*)$/))&&window.hotcrp_pctags?(a=a[1].match(/^(\S*)/),make_suggestions(c[2],a[1],b)(hotcrp_pctags)):null}function comment_completion_q(a,b){a=completion_split(a);var c;return a&&(c=a[0].match(/.*?(?:^|[\s,;])@([-\w_.]*)$/))?(a=a[1].match(/^([-\w_.]*)/),allmentions.then(make_suggestions(c[1],a[1],b))):null}
function make_suggestions(a,b,c){if(3<arguments.length){c=$.extend({},c);for(var d=3;d<arguments.length;++d)$.extend(c,arguments[d])}c=c||{};var e=c.case_sensitive,l=c.decorate,k=c.prefix||"",g=k+a+b;g=e?g:g.toLowerCase();var f=null;(k.length||c.filter_length)&&g.length&&(f=g.substr(0,k.length+(c.filter_length||0)));var m=[k.length+a.length,b.length,(c.suffix||"").length];return function(a){for(var b=[],c=null,d=g.length>k.length,h=0;h<a.length;++h){var y=completion_item(a[h]),t=y.s,D=e?t:t.toLowerCase();
if(!(null!==f&&D.substr(0,f.length)!==f||y.filter_length&&(g.length<y.filter_length||D.substr(0,y.filter_length)!==g.substr(0,y.filter_length)))){d&&D.substr(0,g.length)===g&&(c=b.length,d=!1);D='<div class="suggestion">';if(l)if(D+='<span class="suggestion-text">'+escape_entities(t)+"</span>",y.description_html||y.dh)D+=' <span class="suggestion-description">'+(y.description_html||y.dh)+"</span>";else{if(y.description||y.d)D+=' <span class="suggestion-description">'+escape_entities(y.description||
y.d)+"</span>"}else D+=escape_entities(t);b.push(D+"</div>")}}return b.length?(null!==c&&(b[c]=b[c].replace(/^<div class="suggestion/,'<div class="suggestion active')),{list:b,lengths:m}):null}}
function suggest(a,b,c){function d(){v&&v.remove();v=null;n=w=y=!1;t=0}function e(b){if(!b||!b.list.length)return d();var c=a.selectionStart,e=c-b.lengths[0];if(!w||w!==a.value.substring(e,c)){w=!1;v||(v=make_bubble({dir:"nw",color:"suggest"}),v.self().on("mousedown",function(a){a.preventDefault()}).on("click","div.suggestion",m).on("mousemove","div.suggestion",h));var f=[10,30,60,90,120];for(c=0;c<f.length&&b.list.length>f[c];++c);c='<div class="suggesttable suggesttable'+(c+1)+'">'+b.list.join("")+
"</div>";f=jQuery(a);var g=textarea_shadow(f,"INPUT"==a.tagName?2E3:0);g.text(a.value.substring(0,e)).append("<span>&#x2060;</span>").append(document.createTextNode(a.value.substring(e)));var k=g.find("span").geometry(),l=g.offset();k=geometry_translate(k,-l.left-f.scrollLeft(),-l.top+4-f.scrollTop());v.html(c).near(k,a);v.self().data("autocompletePos",[e,b.lengths]);g.remove()}}function l(){function b(d){++c;d||c==D.promises.length?e(d):(d=D.promises[c](a,D.options))&&$.isFunction(d.then)?d.then(b):
b(d)}var c=-1;b(null)}function k(b){b=b.firstChild.nodeType===Node.TEXT_NODE?b.textContent:b.firstChild.textContent;var c=v.self().data("autocompletePos"),d=a.value,e=c[0],f=e+c[1][0]+c[1][1]+c[1][2];c[1][2]&&(b+=d.substring(f-c[1][2],f));c=e+b.length+1;if(f==d.length||/\S/.test(d.charAt(f)))b+=" ";$(a).val(d.substring(0,e)+b+d.substring(f));a.selectionStart=a.selectionEnd=c}function g(b){var c=v.self().find(".suggestion"),d=v.self().find(".suggestion.active"),e=null;if(!d.length)if("ArrowUp"===b)e=
-1;else if("ArrowDown"===b)e=0;else return!1;else if("ArrowUp"===b||"ArrowDown"===b){for(e=0;e!==c.length-1&&c[e]!==d[0];++e);e+="ArrowDown"===b?1:-1}else if(("ArrowLeft"===b||"ArrowRight"===b)&&0<t){for(var f=d.geometry(),g=Infinity,h=Infinity,k=(b="ArrowLeft"===b)?"left":"right",m=0;m!=c.length;++m){var l=$(c[m]).geometry(),n=f[k]-l[k],r=Math.abs(n);l=Math.abs(f.top+f.bottom-(l.top+l.bottom));(b?0<n:0>n)&&(r<g||r==g&&l<h)&&(e=m,g=r,h=l)}if(null===e&&a.selectionStart==(b?0:a.value.length))return t=
2,!0}return null!==e?(e=(e+c.length)%c.length,c[e]!==d[0]&&(d.removeClass("active"),$(c[e]).addClass("active")),t=2,!0):!1}function f(a){var b=event_key(a),c=event_modkey(a),e=!0;if("Escape"!==b||c)if("Tab"!==b&&"Enter"!==b||c||!v)"Arrow"===b.substring(0,5)&&!c&&v&&g(b)?(a.preventDefault(),e=!1):(v||event_key.printable(a)||"Backspace"===b)&&setTimeout(l,1);else{if(c=v.self().find(".suggestion.active"),"Enter"===b&&"Backspace"===y||!c.length||k(c[0]),d(),c.length||this.selectionEnd!==this.value.length)a.preventDefault(),
a.stopImmediatePropagation(),e=!1}else v&&(c=v.self().data("autocompletePos"),d(),w=this.value.substring(c[0],c[0]+c[1][0]),a.stopImmediatePropagation());y=b;t=Math.max(t-1,0);return e}function m(a){k(this);d();a.stopPropagation()}function h(a){v.self().find(".active").removeClass("active");$(this).addClass("active");y="Arrow";t=1}function r(){n=!0;setTimeout(function(){n&&d()},10)}var v,n=!1,w=!1,y=!1,t=0;"string"===typeof a&&(a=$(a));if(a.jquery)a.each(function(){suggest(this,b,c)});else if(a){var D=
$(a).data("suggest");D||(D={promises:[]},$(a).data("suggest",D).on("keydown",f).on("blur",r),a.autocomplete="off");0>$.inArray(b,D.promises)&&D.promises.push(b);c&&(D.options=$.extend(D.options||{},c))}}$(function(){suggest($(".papersearch"),taghelp_q)});
function setfollow(){var a=$(this);$.post(hoturl_post("api/follow",{p:a.attr("data-pid")||hotcrp_paperid}),{following:this.checked,reviewer:a.data("reviewer")||hotcrp_user.email},function(b){setajaxcheck(a[0],b);b.ok&&(a[0].checked=b.following)})}
var add_revpref_ajax=function(){function a(a,g){a=$(a);if(a.is("input")){var f=wstorage(!0,"revpref_focus");f&&3E3>now_msec()-f&&focus_at(a[0]);a=a.parent()}a.off(".revpref_ajax").on("blur.revpref_ajax","input.revpref",b).on("change.revpref_ajax","input.revpref",c).on("keydown.revpref_ajax","input.revpref",make_onkey("Enter",c));g&&($(document).on("click","a",d),$(window).on("beforeunload",e))}function b(){g=now_msec()}function c(){var a=this,b=this.name.substr(7),c=null,d;0<(d=b.indexOf("u"))&&(c=
b.substr(d+1),b=b.substr(0,d));++l;$.ajax(hoturl_post("api/revpref",{p:b}),{method:"POST",data:{pref:a.value,u:c},success:function(b){setajaxcheck(a,b);b.ok&&null!=b.value&&(a.value="0"===b.value?"":b.value)},complete:function(a,b){--l;k&&k()}})}function d(a){return l&&event_key.is_default_a(a,this)?(k=make_link_callback(this),!1):!0}function e(){(g&&1E3>now_msec()-g||$(":focus").is("input.revpref"))&&wstorage(!0,"revpref_focus",g||now_msec())}var l=0,k=null,g=0;a.then=function(a){l?k=a:a()};handle_ui.on("revpref",
function(a){"keydown"===a.type?event_modkey(a)||"Enter"!==event_key(a)||(a.preventDefault(),a.stopImmediatePropagation(),c.call(this)):"change"===a.type&&c.call(this)});return a}();
window.plinfo_tags=function(){function a(a){return a&&/^~[^~]/.test(a)?hotcrp_user.cid+a:a}function b(a){a=a.replace(/^\s+|\s+$/,"").toLowerCase();return"y"==a||"yes"==a||"t"==a||"true"==a||"\u2713"==a?0:"n"==a||"no"==a||""==a||"f"==a||"false"==a||"na"==a||"n/a"==a||"clear"==a?!1:a.match(/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)$/)?+a:null}function c(a){return!1===a||null===a?"":sprintf("%.2f",a).replace(/\.0+$|0+$/,"")}function d(a,b){if(!b.empty){b.tag&&a.setAttribute("data-tags",null===b.annoid?"":b.tag+
"#"+b.tagval);var c=null===b.heading?"":b.heading;a=$(a).find(".plheading-group").attr({"data-format":b.format||0,"data-title":c});a.text(""===c?c:c+" ");b.format&&render_text.on.call(a[0])}}function e(a,b,c,e){a=a||b.parentElement;var f=$(a).find("thead > tr.pl_headrow:first-child > th");a=0;for(var g=f.length,h=0;h!=g;++h)$(f[h]).hasClass("pl_title")&&(a=h);e.empty?f='<tr class="plheading-blank"><td class="plheading" colspan="'+g+'"></td></tr>':(f='<tr class="plheading"',e.tag&&(f+=' data-anno-tag="'+
e.tag+'"'),e.annoid&&(f+=' data-anno-id="'+e.annoid+'" data-tags="'+e.tag+"#"+e.annoId+'"'),f+=">",a&&(f+='<td class="plheading-spacer" colspan="'+a+'"></td>'),f+='<td class="plheading" colspan="'+(g-a)+'"><span class="plheading-group"></span><span class="plheading-count"></span></td></tr>');a=$(f)[0];e.tag&&e.tag===V&&y.call($(a).find("td.plheading")[0]);b.insertBefore(a,c);d(a,e);return a}function l(a){var b=[/\bk1\b/,/\bk0\b/];a=a.firstChild;for(var c=1,d=0;a;a=a.nextSibling)if("TR"==a.nodeName){var e=
a.className;/^pl(?: |$)/.test(e)&&(c=1-c,++d,$(a.firstChild).find(".pl_rownum").text(d+". "));if(b[c].test(e))a.className=e.replace(/\bk[01]\b/,"k"+c);else if(/^plheading/.test(e)){c=1;e=0;for(var f=a.nextSibling;f;f=f.nextSibling)if("TR"==f.nodeName){if(/^plheading/.test(f.className))break;e+=/^plx/.test(f.className)?0:1}e=plural(e,"paper");f=$(a).find(".plheading-count");f.html()!==e&&f.html(e)}}}function k(a,b,c,d){var f=$(a).children().filter("tbody")[0];d&&$(f).detach();for(var g=[],h=0,k=f.firstChild,
m;k;)1==k.nodeType&&(h=k.getAttribute("data-pid"))&&(g[h]=g[h]||[]),m=k.nextSibling,h?g[h].push(k):f.removeChild(k),k=m;h=(k=f.firstChild)?k.getAttribute("data-pid"):0;var n=m=0;for(c=c||[];m<b.length||n<c.length;)if(n<c.length&&c[n].pos==m)e(a,f,k,c[n]),++n;else{var r=b[m];if(h==r){do(k=k.nextSibling)&&1!=k.nodeType||(h=k?k.getAttribute("data-pid"):0);while(h==r)}else{for(var X=0;g[r]&&X<g[r].length;++X)f.insertBefore(g[r][X],k);delete g[r]}++m}d&&$(f).appendTo(a);l(f)}function g(a){var b=[],c;for(a=
$(a).children().filter("tbody")[0].firstChild;a;a=a.nextSibling)1===a.nodeType&&/^pl\b/.test(a.className)&&(c=a.getAttribute("data-pid"))&&b.push(+c);return b}function f(a,b){var c=/^([^#]*[?&;]sort=)([^=&;#]*)(.*)$/.exec(a);return null==b?c?urldecode(c[2]):null:c?c[1]+urlencode(b)+c[3]:hoturl_add(a,"sort="+urlencode(b))}function m(a,b){var c=a.replace(/[ +]+reverse\b/,"");null==b&&(b=c==a);return c+(b?" reverse":"")}function h(a,b,c){k(a,c.ids,c.groups,!0);$(a).data("groups",c.groups);a.setAttribute("data-hotlist",
c.hotlist||"");var d=c.fwd_sorter||f(b)||"id",e=d&&m(d,!1);$(a).children("thead").find("a.pl_sort").removeClass("pl_sorting_fwd pl_sorting_rev").each(function(){var a=this.getAttribute("href"),b=m(f(a),!1);b===e&&(d!==e?$(this).addClass("pl_sorting_rev"):($(this).addClass("pl_sorting_fwd"),b=m(b,!0)));this.setAttribute("href",f(a,b))});a=$(a).closest("form");if(a.length){if(a[0].hasAttribute("data-original-action")){var g=a[0].getAttribute("data-original-action",g);a[0].removeAttribute("data-original-action")}else g=
a[0].action;a[0].action=f(g,d)}}function r(a,b){var c=/^([^?#]*search(?:\.php)?)(\?[^#]*)/.exec(b);$.ajax(hoturl("api/search",c[2]),{method:"GET",cache:!1,success:function(d){var e=$(a).closest("table")[0],f;if(f=d.ok&&d.ids){f=d.ids;var k=g(e);k.sort();f=[].concat(f);f.sort();f=k.join(" ")===f.join(" ")}f?(push_history_state(),h(e,b,d),push_history_state(c[1]+c[2]+location.hash)):window.location=b}})}function v(a){var b;return event_key.is_default_a(a)&&(b=this.getAttribute("href"))&&/search(?:\.php)?\?/.test(b)?
(r(this,b),!1):!0}function n(a){var b=$(this).val(),c=/ (?:counts|average|median|variance|maxmin|my)\b/;$.post(hoturl_post("api/setsession"),{v:"scoresort="+b});plinfo.set_scoresort(b);$("#foldpl > thead").find("a.pl_sort").each(function(){var a=this.getAttribute("href"),d=f(a);c.test(d)&&(d=d.replace(c," "+b),this.setAttribute("href",f(a,d)),/\bpl_sorting_(?:fwd|rev)/.test(this.className)&&r(this,f(a,m(d))))});return!1}function w(){function a(a){a=a.replace(/&forceShow=[^&#]*/,"");b&&(a=a.replace(/^([^#]*?)(#.*|)$/,
"$1&forceShow=1$2"));return a}var b=this.checked,c=a(window.location.href);$("#foldpl > thead").find("a.pl_sort").each(function(){var b=a(this.getAttribute("href"));this.setAttribute("href",b);if(/\bpl_sorting_(?:fwd|rev)/.test(this.className)&&!$(this).closest("th").hasClass("pl_id")){var d=f(b);c=f(b,m(d))}});r($("#foldpl"),c)}function y(){var a=document.createElement("span");a.className="dragtaghandle";a.setAttribute("title","Drag to change order");"TD"===this.tagName?(a.style.float="right",a.style.position=
"static",a.style.paddingRight="24px",this.insertBefore(a,null)):this.parentElement.insertBefore(a,this.nextSibling);$(this).removeClass("need-draghandle")}function t(a,c,d,e,f,g){this.tbody=a;this.l=c;this.r=d;this.index=e;a=a.childNodes;d=a[c].getAttribute("data-tags");var h;this.tagvalue=!1;d&&(h=(new RegExp("(?:^| )"+regexp_quote(f)+"#(\\S+)","i")).exec(d))&&(this.tagvalue=b(h[1]));this.isgroup=!1;this.id=0;a[c].getAttribute("data-anno-tag")?(this.isgroup=!0,a[c].hasAttribute("data-anno-id")&&
(this.annoid=+a[c].getAttribute("data-anno-id"))):(this.id=+a[c].getAttribute("data-pid"),g&&(this.entry=$(a[c]).find("input[name='tag:"+g+" "+this.id+"']")[0]))}function D(){for(var a=[],b=0;4>a.length;)a.push([1,1,1,1,1,2,2,2,3,4][Math.floor(10*Math.random())]);return function(c){c&&(b=3);++b;return a[b&3]}}function B(b){b=$(b).closest("table.pltable");(L=a(b.attr("data-order-tag")))&&plinfo.on_set_tags(C);N=b.attr("data-drag-tag");V=a(N);I=$(b).children().filter("tbody")[0];b.off(".edittag_ajax").on("click.edittag_ajax",
"input.edittag",E).on("change.edittag_ajax","input.edittagval",E).on("keydown.edittag_ajax","input.edittagval",make_onkey("Enter",E));if(V)b.on("mousedown.edittag_ajax","span.dragtaghandle",Q)}function H(a){return function(b){var c=document.activeElement;a&&setajaxcheck(a,b);if(b.ok){var d=b.p||{};b.pid&&(d[b.pid]=b);W=!0;for(var e in d)plinfo.set_tags(+e,d[e]);W=!1;c&&c.focus()}}}function C(a){a=u(a);q[a].entry&&W&&setajaxcheck(q[a].entry);O(a)}function E(){var a=this.name.match(/^tag:(\S+) (\d+)$/);
if("checkbox"==this.type.toLowerCase())var c=this.checked?a[1]:a[1]+"#clear";else if(null!==(c=b(this.value)))c=a[1]+"#"+(!1!==c?c:"clear");else{setajaxcheck(this,{ok:!1,error:"Value must be a number (or empty to remove the tag)."});return}$.post(hoturl_post("api/settags",{p:a[2],forceShow:1}),{addtags:c},H(this))}function u(a){for(var b=I.childNodes,c,d,e,f=null;a&&"number"!==typeof a&&"TR"!=a.nodeName;)a=a.parentElement;q=[];c=0;for(d=null;c<b.length;++c)"TR"==b[c].nodeName&&(/^plx/.test(b[c].className)?
e=c:(null!==d&&q.push(new t(I,d,e,q.length,L,N)),d=e=c),a==b[c]&&(f=q.length));null!==d&&q.push(new t(I,d,e,q.length,L,N));if("number"===typeof a)for(c=0;c<q.length;++c)if(q[c].id==a){f=c;break}d=b=a=0;e=null;for(c=0;c<q.length;++c)q[c].id&&!1!==q[c].tagvalue&&(null!==e&&(e=q[c].tagvalue-e,++b,a+=e,d+=e*e),e=q[c].tagvalue);q.gapf=4<=b&&a>=.9*b&&a<=1.1*b&&d>=.9*b&&d<=1.1*b?function(){return 1}:D();return f}function A(){var a=$(window).geometry(),b=0,c=Y.clientY+a.top;c<a.top-5?b=Math.max((c-(a.top-
5))/10,-10):c>a.bottom?b=Math.min((c-(a.bottom+5))/10,10):c>=a.top&&c<=a.bottom&&(R=(clearInterval(R),null));b&&(U+=b,b=Math.round(U))&&(window.scroll(a.left,a.top+b),U-=b)}function z(a){if(a<q.length&&q[a].isgroup)for(;a+1<q.length&&!q[a+1].isgroup;)++a;return a}function x(a){a=a||window.event;null==a.clientX&&(a=Y);Y={clientX:a.clientX,clientY:a.clientY};for(var b=$(window).geometry(),d=a.clientX+b.left,e=a.clientY+b.top,f=0,g=q.length,h;f<g;)if(h=Math.floor((f+g)/2),e<q[h].top())g=h;else if(e<
q[h].bottom()){f=h;break}else f=h+1;if(q[F].isgroup&&q[F+1]&&!q[F+1].isgroup)for(;0<f&&f<q.length&&!q[f].isgroup;)--f;g=z(f);f<q.length&&e>(q[f].top()+q[g].bottom())/2&&(f=g+1);g=$(I).geometry();if(d<Math.min(b.left,g.left)-30||d>Math.max(b.right,g.right)+30||e<g.top-40||e>g.bottom+40)f=F;!R&&(e<b.top||e>b.bottom)&&(R=setInterval(A,13),U=0);if(f==F||f==z(F)+1)f=F;if(f!==M){M=f;T||(T=make_bubble({color:"edittagbubble dark",dir:"1!*"}),window.disable_tooltip=!0);M==F?e=q[M].tagvalue:(p(F,M),e=q[F].newvalue);
b="";q[F].id&&(b+="#"+q[F].id);if(d=q[F].titlehint())b+=(b?" &nbsp;":"")+d;!1!==e?(b+='<span style="padding-left:2em',F!==M&&(b+=";font-weight:bold"),b+='">#'+N+"#"+c(e)+"</span>"):b+='<div class="hint">Untagged \u00b7 Drag up to set order</div>';e=M==F?q[F].middle():M<q.length?q[M].top():q[q.length-1].bottom();d=q[F].entry?$(q[F].entry).offset().left-6:q[F].right()-20;T.html(b).at(d,e).color("edittagbubble dark"+(F==M?" sametag":""));"mousemove"===a.type&&a.stopPropagation()}}function p(a,b){var c=
z(a),d,e=q.gapf(!0);if(!1!==q[a].tagvalue&&c+1<q.length&&!1!==q[c+1].tagvalue){var f=q[c+1].tagvalue-q[c].tagvalue;1<=f&&(e=f)}c!=a&&q[c].tagvalue&&(e+=q[c].tagvalue-q[a].tagvalue);var g=-Infinity,h=0,k=!1;for(f=0;f<q.length;++f)q[f].newvalue=q[f].tagvalue;for(f=0;f<q.length;++f)if(!1===q[f].tagvalue?g=0==f?1:!1===q[f-1].tagvalue?!1:1==f||4>=(d=q[f-1].tagvalue-q[f-2].tagvalue)?g+q.gapf():g+d:(0<f&&q[f].tagvalue>q[f-1].tagvalue+q.gapf()&&q[f].tagvalue>g&&(h=0),f==b&&!k&&!q[a].isgroup&&0<f&&(q[f-1].isgroup?
h=q[f-1].newvalue-q[f].tagvalue:q[f].isgroup&&(h=q[f-1].newvalue+q.gapf()-q[f].tagvalue)),g=q[f].tagvalue+h),f==a&&a<b)!1!==q[f+1].tagvalue&&(h=-(q[f+1].tagvalue-q[f].tagvalue));else if(f==a)h-=e;else if(!(f>=a&&f<=c))if(f!=b||k){if(f>=b&&!1===q[f].tagvalue||f>=a&&f>=b&&q[f].tagvalue>=g)break;!1!==q[f].tagvalue&&(q[f].newvalue=g)}else{for(d=a;d<=c;++d)q[d].newvalue=!1===g?g:g+(q[d].tagvalue-q[a].tagvalue);h+=e;g=q[c].newvalue;--f;k=!0}if(q.length==b)for(!1!==g&&(g+=q.gapf()),d=a;d<=c;++d)q[d].newvalue=
!1===g?g:g+(q[d].tagvalue-q[a].tagvalue)}function G(a,b){var c=q[a].tagvalue,d=q[b].tagvalue;if(!1===c!==(!1===d))return!1===c?1:-1;if(c!=d)return c<d?-1:1;c=q[a].id;d=q[b].id;if(!c!==!d)return c?1:-1;if(c!==d)return c<d?-1:1;d=I.childNodes;c=$(d[q[a].l]).find(".plheading-group").attr("data-title");d=$(d[q[b].l]).find(".plheading-group").attr("data-title");return(c=strnatcmp(c,d))?c:q[a].annoid-q[b].annoid}function O(a){var b=I.childNodes,c;for(c=0;c<q.length&&!(c!==a&&0>G(a,c));++c);if(c!==a+1){var d=
[q[a].l,q[a].r],e;for(e=c<q.length?b[q[c].l]:null;d[0]<=d[1];){var f=I.removeChild(b[d[0]]);I.insertBefore(f,e);a>c?++d[0]:--d[1]}l(I)}}function J(a){if(a.ok){for(var b=$("tr.plheading").filter('[data-anno-tag="'+a.tag+'"]'),c={},f=0;f<a.anno.length;++f){var g=a.anno[f],h=b.filter('[data-anno-id="'+g.annoid+'"]')[0];h?d(h,g):h=e(null,I,null,g);c[g.annoid]=!0;a.tag===L&&O(u(h))}for(f=0;f<b.length;++f)a=b[f].getAttribute("data-anno-id"),null===a||c[a]||$(b[f]).remove()}}function Q(a){a=a||window.event;
P&&K();P=this;M=null;F=u(this);document.addEventListener?(document.addEventListener("mousemove",x,!0),document.addEventListener("mouseup",K,!0),document.addEventListener("scroll",x,!0)):(P.setCapture(),P.attachEvent("onmousemove",x),P.attachEvent("onmouseup",K),P.attachEvent("onmousecapture",K));a.stopPropagation();event_prevent(a)}function K(a){document.removeEventListener?(document.removeEventListener("mousemove",x,!0),document.removeEventListener("mouseup",K,!0),document.removeEventListener("scroll",
x,!0)):(P.detachEvent("onmousemove",x),P.detachEvent("onmouseup",K),P.detachEvent("onmousecapture",K),P.releaseCapture());T&&(T=T.remove(),delete window.disable_tooltip);R&&(R=(clearInterval(R),null));if(null!==F&&(null===M||F!=M)){a=F;var b=[],d=[];p(a,M);for(var e=0;e<q.length;++e)if(q[e].newvalue!==q[e].tagvalue)if(q[e].id){var f=c(q[e].newvalue);b.push(q[e].id+" "+N+"#"+(""===f?"clear":f))}else q[e].annoid&&d.push({annoid:q[e].annoid,tagval:c(q[e].newvalue)});b.length&&$.post(hoturl_post("api/settags",
{forceShow:1}),{tagassignment:b.join(",")},H(q[a].entry));d.length&&$.post(hoturl_post("api/taganno",{tag:N,forceShow:1}),{anno:JSON.stringify(d)},J)}P=F=M=null}function S(){I||B(this);removeClass(this,"need-editable-tags")}$(document).on("collectState",function(a,b){if((a=document.getElementById("foldpl"))&&a.hasAttribute("data-sort-url-template")){var c=$(a).data("groups");c&&"string"===typeof c&&(c=JSON.parse(c));c=b.sortpl={ids:g(a),groups:c,hotlist:a.getAttribute("data-hotlist")};f(b.href)||
(b=$(a).children("thead").find("a.pl_sorting_fwd").attr("href"))&&(b=f(b))&&(c.fwd_sorter=m(b,!1))}});"pushState"in window.history&&($(document).on("click","a.pl_sort",v),$(window).on("popstate",function(a){a=(a.originalEvent||a).state;var b;a&&a.sortpl&&(b=document.getElementById("foldpl"))&&h(b,a.href,a.sortpl)}),$(function(){$("#scoresort").on("change",n);$("#showforce").on("click",w)}));t.prototype.top=function(){return $(this.tbody.childNodes[this.l]).offset().top};t.prototype.bottom=function(){return $(this.tbody.childNodes[this.r]).geometry().bottom};
t.prototype.middle=function(){return(this.top()+this.bottom())/2};t.prototype.right=function(){return $(this.tbody.childNodes[this.l]).geometry().right};t.prototype.titlehint=function(){var a=$(this.tbody.childNodes[this.l]).find("a.ptitle, span.plheading-group"),b=null,c;a.length&&((b=a[0].getAttribute("data-title"))||(b=a.text()),b&&60<b.length&&(c=/^.{0,60}(?=\s)/.exec(b))?b=c[0]+"\u2026":b&&60<b.length&&(b=b.substr(0,60)+"\u2026"));return b};var I,L,N,V,q,W,P,F,M,T,R,Y,U;S.edit_anno=function(a){function b(a){if("add"===
this.name)a=new HtmlCollector,f(a,{}),a=$(a.render()),a.appendTo(g.find(".tagannos")),g.find(".popup-bottom").scrollIntoView(),popup_near(g,window),a.find("input[name='heading_n"+k+"']").focus();else{a=[];for(var b=0;b<h.length;++b){var c=g.find("input[name='heading_"+h[b].annoid+"']").val(),d=g.find("input[name='tagval_"+h[b].annoid+"']").val(),l=g.find("input[name='deleted_"+h[b].annoid+"']").val();(c!=h[b].heading||d!=h[b].tagval||l)&&a.push({annoid:h[b].annoid,heading:c,tagval:d,deleted:!!l})}for(b=
1;b<=k;++b)c=g.find("input[name='heading_n"+b+"']").val(),d=g.find("input[name='tagval_n"+b+"']").val(),""==c&&0==d||a.push({annoid:"new",heading:c,tagval:d});$.post(hoturl_post("api/taganno",{tag:m}),{anno:JSON.stringify(a)},e(g))}return!1}function d(){var a=$(this).closest(".settings-revfield"),b=a.attr("data-anno-id");a.find("input[name='tagval_"+b+"']").after("[deleted]").remove();a.append('<input type="hidden" name="deleted_'+b+'" value="1">');a.find("input[name='heading_"+b+"']").prop("disabled",
!0);tooltip.erase.call(this);$(this).remove();return!1}function e(a){return function(b){setajaxcheck(a.find("button[name=save]"),b);b.ok&&(J(b),popup_close(a))}}function f(a,b){var c=b.annoid;null==c&&(c="n"+(k+=1));a.push('<div class="settings-revfield" data-anno-id="'+c+'"><table><tbody>',"</tbody></table></div>");a.push('<tr><td class="lcaption nw">Description</td><td class="lentry"><input name="heading_'+c+'" type="text" placeholder="none" size="32"></td></tr>');a.push('<tr><td class="lcaption nw">Start value</td><td class="lentry"><input name="tagval_'+
c+'" type="text" size="5">',"</td></tr>");b.annoid&&a.push(' <a class="ui closebtn delete-link need-tooltip" href="#" style="display:inline-block;margin-left:0.5em" data-tooltip="Delete group">x</a>');a.pop_n(2)}var g;a=$(a).closest("tr")[0];var h,k=0;I||B(a);var m=a.getAttribute("data-anno-tag");a.hasAttribute("data-anno-id")&&a.getAttribute("data-anno-id");$.get(hoturl_post("api/taganno",{tag:m}),function(a){if(a.ok&&a.editable){var e=popup_skeleton();e.push("<h2>Annotate #"+m.replace(/^\d+~/,"~")+
" order</h2>");e.push('<div class="tagannos">',"</div>");h=a.anno;for(a=0;a<h.length;++a)f(e,h[a]);e.pop();e.push('<div class="g"><button type="button" name="add" class="btn">Add group</button></div>');e.push_actions(['<button type="submit" name="save" class="btn btn-primary">Save changes</button>','<button type="button" name="cancel" class="btn">Cancel</button>']);g=e.show();for(a=0;a<h.length;++a)g.find("input[name='heading_"+h[a].annoid+"']").val(h[a].heading),g.find("input[name='tagval_"+h[a].annoid+
"']").val(c(h[a].tagval));g.on("click","button",b).on("click","a.delete-link",d)}})};S.add_draghandle=y;return S}();
handle_ui.on("js-expand-archive",function(a){var b=$(a?a.target:this).closest(".archive");fold(b[0]);b.find(".archiveexpansion").length||(b.append('<span class="archiveexpansion fx"></span>'),$.ajax(hoturl_add(b.find("a").filter(":not(.qq)").attr("href"),"fn=consolidatedlisting"),{method:"GET",success:function(a){a.ok&&a.result&&b.find(".archiveexpansion").text(" ("+a.result+")")}}));return!1});
function popup_skeleton(a){var b=new HtmlCollector,c=null;a=a||{};b.push('<div class="popupbg"><div class="popupo'+(a.anchor&&a.anchor!=window?"":" popupcenter")+'"><form enctype="multipart/form-data" accept-charset="UTF-8">','</form><div class="popup-bottom"></div></div></div>');b.push_actions=function(a){b.push('<div class="popup-actions">',"</div>");a&&b.push(a.join("")).pop();return b};b.show=function(d){c||(c=$(b.render()).appendTo(document.body),c.find(".need-tooltip").each(tooltip),c.on("click",
function(a){a.target===c[0]&&popup_close(c)}),c.find("button[name=cancel]").on("click",function(){popup_close(c)}),a.action&&c.find("form").attr({action:a.action,method:a.method||"post"}),a.maxWidth&&c.children().css("maxWidth",a.maxWidth));!1!==d&&(popup_near(c,a.anchor||window),c.find("textarea, input[type=text]").autogrow());return c};return b}
function popup_near(a,b){tooltip.erase();a.jquery&&(a=a[0]);hasClass(a,"popupbg")&&(a=a.childNodes[0]);var c={left:0,top:0};hasClass(a.parentNode,"popupbg")&&(a.parentNode.style.display="block",c=$(a.parentNode).offset());var d=$(b).geometry(),e=$(window).geometry(),l=(d.right+d.left-a.offsetWidth)/2,k=(d.top+d.bottom-a.offsetHeight)/2;b===window&&(k=Math.min((3*d.top+d.bottom)/4,k));l=Math.max(e.left+5,Math.min(e.right-5-a.offsetWidth,l))-c.left;k=Math.max(e.top+5,Math.min(e.bottom-5-a.offsetHeight,
k))-c.top;a.style.left=l+"px";a.style.top=k+"px";a=$(a).find("input, button, textarea, select").filter(":visible");(a=a.filter(".want-focus")[0]||a.filter(":not(.dangerous)")[0])&&focus_at(a)}function popup(a,b,c){var d=$$("popup_"+b);d||log_jserror("no popup "+b);c?(d.className="popupc",/popupbg/.test(d.parentNode.className)&&(d.parentNode.style.display="none")):(d.className="popupo",popup_near(d,a));return!1}
function popup_close(a){tooltip.erase();a.find("textarea, input[type=text]").unautogrow();a.remove()}
function override_deadlines(a){var b=$(this),c=$('<div class="popupbg"><div class="popupo"><p>'+(b.attr("data-override-text")||"Are you sure you want to override the deadline?")+'</p><form><div class="popup-actions"><button type="button" name="bsubmit" class="btn btn-primary"></button><button type="button" name="cancel" class="btn">Cancel</button></div></form></div></div>');c.find("button[name=cancel]").on("click",function(){c.remove()});c.find("button[name=bsubmit]").html(b.attr("aria-label")||b.html()||
b.attr("value")||"Save changes").on("click",function(){if(a&&$.isFunction(a))a();else{var d=b.closest("form");d.children("div").first().append('<input type="hidden" name="'+b.attr("data-override-submit")+'" value="1"><input type="hidden" name="override" value="1">');d.addClass("submitting");d[0].submit()}c.remove()});c.appendTo(document.body);popup_near(c,this)}handle_ui.on("js-override-deadlines",override_deadlines);
function check_version(a,b){function c(a){var b;a&&a.messages&&(b=$$("initialmsgs"))&&(b.innerHTML=a.messages+b.innerHTML)}var d;try{if((d=wstorage.json(!1,"hotcrp_version_check"))&&d.at>=now_msec()-6E5&&d.version==b)return}catch(e){}$.ajax(a+"&site="+encodeURIComponent(window.location.toString()),{method:"GET",dataType:"json",cache:!0,crossDomain:!1,jsonp:!1,global:!1,success:function(a){a&&a.updates&&window.JSON?jQuery.get(siteurl+"checkupdates.php",{data:JSON.stringify(a)},c):a&&a.status&&wstorage(!1,
"hotcrp_version_check",{at:now_msec(),version:b})}});handle_ui.on("js-check-version-ignore",function(){var a=$(this).data("versionId");$.post(siteurl+"checkupdates.php",{ignore:a,post:siteurl_postvalue});$("#softwareupdate_"+a).hide()})}
var plinfo=function(){function a(a){var b,c=0;for(b=0;b!==G.length&&G[b]!==a;++b)!G[b].column!==!a.column||G[b].missing||++c;return c}function b(){var a={};$("tr.pl").each(function(){a[+this.getAttribute("data-pid")]=this});return a}function c(a,b){$(b).each(function(){var b="TR"===this.tagName?this:this.parentNode;b.hasAttribute("data-pid")&&(a[+b.getAttribute("data-pid")]=this)})}function d(a){a in Q||c(Q,"tr.pl");return $(Q[a])}function e(a){for(;a&&a.nodeName&&"TR"!==a.nodeName;)a=a.parentNode;
var b;return a&&"TR"===a.nodeName&&(b=a.getAttribute("data-pid"))?+b:null}function l(a,b,c){if(2==arguments.length)return d(a).attr(b);d(a).attr(b,c)}function k(b,e,f){e.column?b=d(b):(b in K||c(K,"tr.plx > td.plx"),b=$(K[b]));b&&null==f&&(f=a(e));return $(b.length?b[0].childNodes[f]:null)}function g(){var a=/(\d+)([PT])(\S+)/g;$(".need-allpref").each(function(){var b=[];var c=e(this);for(var d=l(c,"data-allpref")||"";null!==(c=a.exec(d));){var f=hotcrp_pc[c[1]];f.name_html||(f.name_html=escape_entities(f.name));
var g="";g=f.color_classes?g+('<span class="'+f.color_classes+'">'+f.name_html+"</span>"):g+f.name_html;f=parseInt(c[3]);g+=' <span class="asspref'+(0>f?"-1":"1")+'">'+c[2]+(0>f?c[3].replace(/-/,"\u2212"):c[3])+"</span>";b.push(["P"===c[2]?f:0,f,b.length,g])}b.length?(b.sort(function(a,b){return a[0]!==b[0]?a[0]<b[0]?1:-1:a[1]!==b[1]?a[1]<b[1]?1:-1:a[2]<b[2]?-1:1}),b=b.map(function(a){return a[3]}),g='<span class="nb">'+b.join(',</span> <span class="nb">')+"</span>",$(this).html(g).removeClass("need-allpref")):
$(this).closest("div").empty()})}function f(){if(!1===J){var a;J={};var b=p.tags.highlight_tags||[];for(a=0;a!=b.length;++a){var c=b[a].toLowerCase();"~"===c.charAt(0)&&"~"!==c.charAt(1)&&(c=hotcrp_user.cid+c);J[c]=(J[c]||0)|1}b=p.tags.votish_tags||[];for(a=0;a!=b.length;++a)c=b[a].toLowerCase(),J[c]=(J[c]||0)|2,c=hotcrp_user.cid+"~"+c,J[c]=(J[c]||0)|2;$.isEmptyObject(J)&&(J=null)}return J}function m(a,b){var c=f(),d=[];b=(b||"").split(/ /);for(var e=0;e!=b.length;++e){var g=b[e],h=g.indexOf("~"),
k=g.indexOf("#");if(""!==g&&(0>=h||g.substr(0,h)==hotcrp_user.cid)){h=Math.max(h,0);var m=g.substring(0,k),l=g.substr(k+1),n=c?c[m.toLowerCase()]||0:0;m=m.substring(h,k);var r=n&2?"#"+m+" showsort:-#"+m:"0"!=l?"order:#"+m:"#"+m;m=n&2||"0"!=l?'<a class="nn nw" href="'+hoturl("search",{q:r})+'"><u class="x">#'+m+"</u>#"+l+"</a>":'<a class="qq nw" href="'+hoturl("search",{q:r})+'">#'+m+"</a>";n&1&&(m="<strong>"+m+"</strong>");d.push([m,g.substring(h,k),g.substring(k+1),n])}}d.sort(function(a,b){return(a[3]^
b[3])&1?a[3]&1?-1:1:strnatcmp(a[1],b[1])});d.length||null==a.getAttribute("data-tags-editable")||d.push(["none"]);return $.map(d,function(a){return a[0]})}function h(a){var b=p.tags,c=e(a);c=d(c)[0];var f=m(c,c.getAttribute("data-tags"));f=f.length?'<em class="plx">'+b.title+":</em> "+f.join(" "):"";if(""!=f&&c.hasAttribute("data-tags-conflicted")){f='<span class="fx5">'+f+"</span>";var g=m(c,c.getAttribute("data-tags-conflicted"));g.length&&(f='<span class="fn5"><em class="plx">'+b.title+":</em> "+
g.join(" ")+"</span>"+f)}""!=f&&null!=c.getAttribute("data-tags-editable")&&(f+=' <span class="hoveronly"><span class="barsep">\u00b7</span> <a class="ui edittags-link" href="#">Edit</a></span>',S||($(c).closest("tbody").on("click","a.edittags-link",r),S=!0));$(a).find("textarea").unautogrow();""==f?$(a).empty():$(a).html(f)}function r(){$.post(hoturl_post("api/settags",{p:e(this),forceShow:1}),v)}function v(a){var b;if(a.ok&&a.pid&&(b=k(a.pid,p.tags))){$(b).html('<em class="plx">Tags:</em> <textarea name="tags '+
a.pid+'" style="vertical-align:top;max-width:70%;margin-bottom:2px" cols="120" rows="1" class="want-focus" data-tooltip-dir="v"></textarea> &nbsp;<button type="button" name="tagsave '+a.pid+'" class="btn">Save</button> &nbsp;<button type="button" name="tagcancel '+a.pid+'" class="btn">Cancel</button>');var c=$(b).find("textarea");suggest(c,taghelp_tset);c.val(a.tags_edit_text).autogrow().on("keydown",make_onkey("Enter",n)).on("keydown",make_onkey("Escape",w));$(b).find("button[name^=tagsave]").click(n);
$(b).find("button[name^=tagcancel]").click(w);focus_within(b)}}function n(){var a=this.parentNode,b=e(a);$(a).find("textarea").blur().trigger("hide");$.post(hoturl_post("api/settags",{p:b,forceShow:1}),{tags:$(a).find("textarea").val()},function(c){c.ok?u.set_tags(b,c):setajaxcheck($(a).find("textarea"),c)})}function w(){var a=this.parentNode;$(a).find("textarea").blur().trigger("hide");h(a)}function y(a){var b=/^(?:#|tag:|tagval:)(\S+)/.exec(a.name)[1];/^~[^~]/.test(b)&&(b=hotcrp_user.cid+b);return function(c,
d){c=k(c,a);d=d.tags;var e=null;if(c.length&&!a.missing){for(var f=0;f!=d.length;++f)if(d[f].substr(0,b.length)===b&&"#"===d[f].charAt(b.length)){e=d[f].substr(b.length+1);break}c.find("input").length?(c.find(".edittag").prop("checked",null!==e),c.find(".edittagval").val(null===e?"":String(e))):"0"===e?c.html(/tagval/.test(a.className)?"0":"\u2713"):c.html(null===e?"":e)}}}function t(){x||A();scorechart();g();$(".need-tags").each(function(){h(this.parentNode)});$(".need-editable-tags").each(plinfo_tags);
$(".need-draghandle").each(plinfo_tags.add_draghandle);render_text.on_page()}function D(b){var c=a(b),d=$(x);d.find("tr.plx > td.plx, td.pl_footer, tr.plheading > td:last-child, thead > tr.pl_headrow.pl_annorow > td:last-child, tfoot > tr.pl_statheadrow > td:last-child").each(function(){this.setAttribute("colspan",+this.getAttribute("colspan")+1)});var e=(b.className||"pl_"+b.name)+" fx"+b.foldnum,f=' class="pl '+e+'"',g=b.title,h;b.sort_name&&(h=x.getAttribute("data-sort-url-template"))&&(h=h.replace(/\{sort\}/,
urlencode(b.sort_name)),g='<a class="pl_sort" rel="nofollow" href="'+escape_entities(h)+'">'+g+"</a>");g='<th class="pl plh '+e+'">'+g+"</th>";d.find("thead > tr.pl_headrow:first-child").each(function(){this.insertBefore($(g)[0],this.childNodes[c]||null)});g="<td"+f+"></td>";d.find("tr.pl").each(function(){this.insertBefore($(g)[0],this.childNodes[c]||null)});g='<td class="plstat '+e+'"></td>';d.find("tfoot > tr.pl_statrow").each(function(){this.insertBefore($(g)[0],this.childNodes[c]||null)});b.missing=
!1}function B(b){var c=a(b),d='<div class="'+(b.className||"pl_"+b.name)+" fx"+b.foldnum+'"></div>';$(x).find("tr.plx > td.plx").each(function(){this.insertBefore($(d)[0],this.childNodes[c]||null)});b.missing=!1}function H(a,b,c){b=b[0];var d;b&&(null==c||""===c?b.innerHTML="":(""==b.className&&(b.className="fx"+a.foldnum),!a.title||a.column&&"Loading"!=c||(c="<"==c.charAt(0)&&(d=/^(<(?:div|p)[^>]*>)([\s\S]*)$/.exec(c))?d[1]+'<em class="plx">'+a.title+":</em> "+d[2]:'<em class="plx">'+a.title+":</em> "+
c),b.innerHTML=c))}function C(b,c){function d(){for(var b=a(f),c=f.name+".html",e=0;64>e&&h;h=h.nextSibling)if("TR"===h.nodeName&&h.hasAttribute("data-pid")&&/\bpl\b/.test(h.className)){var m=+h.getAttribute("data-pid"),n;for(n in g)"attr."==n.substr(0,5)&&m in g[n]&&l(m,n.substr(5),g[n][m]);if(g[c]&&m in g[c]){var r=k(m,f,b);r.length||log_jserror("bad pidfield "+JSON.stringify([m,f.name,b]));H(f,r,g[c][m])}++e}t();h&&setTimeout(d,8)}function e(){var b=f;b.missing&&(b.column?D(b):B(b));h=$(x).find("tr.pl").first()[0];
d();if(g[f.name+".stat.html"]){b=$(x).find("tfoot > tr.pl_statrow").first()[0];for(var c=a(f),e=f.name+".stat.html";b;b=b.nextSibling)if("TR"===b.nodeName&&b.hasAttribute("data-statistic")){var k=b.getAttribute("data-statistic"),m=b.childNodes[c];m&&k in g[e]&&(m.innerHTML=g[e][k])}}}var f=p[c],g,h;return function(a){"aufull"===c&&(O[!!b]=a);f.loadable=!1;a.ok&&(g=a,$(e))}}function E(c){function d(){c.missing&&(c.column?D(c):B(c));if(c.loadable){var d=a(c),e;for(e in b())H(c,k(e,c,d),"Loading")}}
return function(){$(d)}}function u(a,b){x||A();var c,d=p[a];d||log_jserror("plinfo missing type "+a);b&&!0!==b&&void 0!==b.checked&&(b=!b.checked);"aufull"!==a&&"anonau"!==a||b||!(c=$$("showau"))||c.checked||c.click();"au"!==a&&"anonau"!==a||!(c=$$("showau_hidden"))||c.checked==$$("showau").checked||c.click();"aufull"!==a&&fold(x,b,{anonau:2,aufull:4,force:5,rownum:6,statistics:7}[a]||p[a].foldnum);var e=$(x).attr("data-fold-session-prefix");if("aufull"===a&&O[!!b])C(b,a)(O[!!b]);else if(!b&&d.loadable&&
"anonau"!==a||"aufull"===a){setTimeout(E(d),750);d=$.extend({fn:"fieldhtml",f:a},hotlist_search_params(x,!0));e&&(d.session=e+a+(b?"=1":"=0"),e=!1);if("au"===a||"aufull"===a)if(d.f="authors","aufull"===a)d.aufull=b?0:1;else if(c=$$("showaufull"))d.aufull=c.checked?1:0;$.get(hoturl_post("api",d),C(b,a))}e&&$.post(hoturl_post("api/setsession",{v:e+a+(b?"=1":"=0")}));a=!1;for(var f in p)if(p[f].has_statistics&&hasClass(x,"fold"+p[f].foldnum+"o")){a=!0;break}fold(x,!a,8);return!1}function A(){x=$("table.pltable")[0];
G=JSON.parse(x.getAttribute("data-columns"));p={};var a=x.getAttribute("data-fold-session-prefix");a&&x.setAttribute("data-fold-session",JSON.stringify({2:a+"anonau",5:a+"force",6:a+"rownum",7:a+"statistics"}));for(a=0;a<G.length;++a)p[G[a].name]=G[a],/^(?:#|tag:|tagval:)\S+$/.test(G[a].name)&&I.push(y(G[a]));p.authors&&(p.au=p.anonau=p.aufull=p.authors)}function z(a){$(function(){var b=a.checked;fold(x,!b,5);$("#forceShow").val(b?1:0);$(x).find(".colorconflict").each(function(){for(var a=this;1!==
a.nodeType||/^plx/.test(a.className);)a=a.previousSibling;a=!b&&a.hasAttribute("data-color-classes-conflicted")?a.getAttribute("data-color-classes-conflicted"):a.getAttribute("data-color-classes");this.className=this.className.replace(/(?:^|\s+)(?:\S*tag|k[01]|tagbg)(?= |$)/g,"").trim()+(a?" "+a:"")})})}var x,p,G,O={},J=!1,Q={},K={},S,I=[];u.set_scoresort=function(a){x||A();for(var b=/ (?:counts|average|median|variance|minmax|my)$/,c=0;c<G.length;++c){var d=G[c];d.sort_name&&(d.sort_name=d.sort_name.replace(b,
" "+a))}};u.render_needed=t;u.set_tags=function(a,b){x||A();var c=d(a);if(c.length){var e=$("tr.pl, tr.plx").filter("[data-pid='"+a+"']");c.removeAttr("data-tags data-tags-conflicted data-color-classes data-color-classes-conflicted").attr("data-tags",$.isArray(b.tags)?b.tags.join(" "):b.tags);"tags_conflicted"in b&&c.attr("data-tags-conflicted",b.tags_conflicted);"color_classes_conflicted"in b?(c.attr("data-color-classes",b.color_classes).attr("data-color-classes-conflicted",b.color_classes_conflicted),
e.addClass("colorconflict")):e.removeClass("colorconflict");var f=b.color_classes;/ tagbg$/.test(b.color_classes||"")&&e.removeClass("k0 k1").closest("tbody").addClass("pltable_colored");c.closest("table").hasClass("fold5c")&&"color_classes_conflicted"in b&&(f=b.color_classes_conflicted);f&&make_pattern_fill(f);e.removeClass(function(a,b){return(b.match(/(?:^| )(?:\S*tag)(?= |$)/g)||[]).join(" ")}).addClass(f);e.find(".tagdecoration").remove();b.tag_decoration_html&&(c=b.tag_decoration_html,"tag_decoration_html_conflicted"in
b&&(c='<span class="fx5">'+c+"</span>",b.tag_decoration_html_conflicted&&(c='<span class="fn5">'+b.tag_decoration_html_conflicted+"</span>"+c)),e.find(".pl_title").append(c));p.tags&&!p.tags.missing&&h(k(a,p.tags)[0]);for(var g in I)I[g](a,b)}};u.on_set_tags=function(a){I.push(a)};u.checkbox_change=function(a){x||A();"show"===this.name.substring(0,4)&&(a=this.name.substring(4),"force"===a?z(this):"rownum"===a?fold(x,!this.checked,6):u(a,this))};handle_ui.on("js-plinfo",function(a){var b=this.getAttribute("data-plinfo-field");
if(b){b=b.split(/\s+/);for(var c=0;c!=b.length;++c)b[c]&&u(b[c],null);a.stopPropagation();event_prevent(a)}});return u}();
window.make_pattern_fill=function(){var a={},b={whitetag:1,redtag:2,orangetag:3,yellowtag:4,greentag:5,bluetag:6,purpletag:7,graytag:8},c={"":{size:34,css:"backgroundColor",incr:8,rule:!0},"gdot ":{size:12,css:"fill",incr:3,pattern:!0},"glab ":{size:20,css:"fill",incr:6,pattern:!0}},d;return function(e,l){if(!e||0>e.indexOf(" "))return null;l=l||"";var k=l+e;if(k in a)return a[k];e=e.split(/\s+/).sort(function(a,c){var d=b[a],e=b[c];return d&&e?d<e?-1:1:d||e?d?-1:1:a.localeCompare(c)});var g;for(g=
0;g<e.length;)!b[e[g]]||g&&e[g]==e[g-1]?e.splice(g,1):++g;var f=l+e.join(" ");if(f in a||1>=e.length)return a[k]=a[f]||null,a[k];var m=c[l]||c[""],h="svgpat__"+f.replace(/\s+/g,"__"),r=m.size+Math.max(0,e.length-2)*m.incr,v=r/e.length,n="";for(g=0;g<e.length;++g){var w=$('<div class="'+l+e[g]+'"></div>').appendTo(document.body),y=w.css(m.css);w.remove();n+='<path d="'+["M",v*g,0,"l",-r,r,"l",v,0,"l",r,-r].join(" ")+'" fill="'+y+'"></path><path d="'+["M",v*g+r,0,"l",-r,r,"l",v,0,"l",r,-r].join(" ")+
'" fill="'+y+'"></path>'}m.pattern&&$("div.body").prepend('<svg width="0" height="0"><defs><pattern id="'+h+'" patternUnits="userSpaceOnUse" width="'+r+'" height="'+r+'">'+n+"</pattern></defs></svg>");m.rule&&window.btoa&&(d||(d=$("<style></style>").appendTo("head")[0].sheet),n="background-image: url(data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="'+r+'" height="'+r+'">'+n+"</svg>")+");",w="."+e.join(".")+(l?$.trim("."+l):""),d.insertRule(w+" { "+n+" }",0),d.insertRule(w+
".psc { "+n+" }",0));a[k]=a[f]="url(#"+h+")";return a[k]}}();
function transfer_form_values(a,b,c){var d={};b.find("input, select, textarea").each(function(){d[this.name]=this});1==a.length&&"DIV"===a[0].firstChild.tagName&&(a=a.children());for(b=0;b!=c.length;++b){var e=c[b],l=null;d[e]&&("checkbox"===d[e].type||"radio"===d[e].type?d[e].checked&&(l=d[e].value):l=$(d[e]).val());var k=a.find("input[name='"+e+"']");null===l?k.remove():(k.length||(k=$('<input type="hidden" name="'+e+'">').appendTo(a)),k.val(l))}}
handle_ui.on("js-forgot-password",function(a){a=popup_skeleton({action:hoturl_post("index",{signin:1,action:"forgot"}),maxWidth:"25rem"});a.push("<p>Enter your email and we\u2019ll send you instructions for signing in.</p>");a.push('<div class="f-i"><label for="forgotpassword_email">Email</label>',"</div>");a.push_pop('<input type="text" name="email" size="36" class="fullw" autocomplete="username" id="forgotpassword_email">');a.push_actions(['<button type="submit" class="btn btn-primary">Reset password</button>',
'<button type="button" name="cancel" class="btn">Cancel</button>']);a=a.show();transfer_form_values(a.find("form"),$(this).closest("form"),["email"])});
handle_ui.on("js-create-account",function(a){a=popup_skeleton({action:hoturl_post("index",{signin:1,action:"new"}),maxWidth:"25rem"});a.push("<h2>Create account</h2>");a.push("<p>Enter your email and we\u2019ll create an account and send you an initial password.</p>");a.push('<div class="f-i"><label for="createaccount_email">Email</label>',"</div>");a.push_pop('<input type="email" name="email" size="36" class="fullw" autocomplete="email" id="createaccount_email">');a.push_actions(['<button type="submit" class="btn btn-primary">Create account</button>',
'<button type="button" name="cancel" class="btn">Cancel</button>']);a=a.show();transfer_form_values(a.find("form"),$(this).closest("form"),["email"])});
handle_ui.on("js-check-format",function(){var a=$(this),b=a.closest(".has-document"),c=b.find(".document-format");this&&"tagName"in this&&"A"===this.tagName&&a.addClass("hidden");var d=setTimeout(function(){c.html(render_xmsg(0,"Checking format (this can take a while)..."))},1E3);$.ajax(hoturl_post("api/checkformat",{p:hotcrp_paperid}),{timeout:2E4,data:{dt:b.data("dtype"),docid:b.data("docid")},success:function(a){clearTimeout(d);a.ok&&c.html(a.response)}})});
handle_ui.on("js-check-submittable",function(a){a=$(this).closest("form");var b=a[0].submitpaper,c=a.attr("data-submitted"),d=!0;this&&"INPUT"===this.tagName&&"file"===this.type&&this.value&&fold(a.find(".ready-container"),!1);b&&"checkbox"===b.type&&(d=b.checked&&$(b).is(":visible"));b=a.attr("data-contacts-only")?"Save contacts":d?c?"Save and resubmit":"Save and submit":"Save draft";a=a.find(".btn-savepaper");a.length&&"INPUT"===a[0].tagName?a.val(b):a.html(b)});
handle_ui.on("js-add-attachment",function(){var a=$($$(this.getAttribute("data-editable-attachments")));a.find(".has-document");var b=a.closest("form"),c=0;do{++c;var d=a[0].getAttribute("data-document-prefix")+"_new_"+c}while(b[0]["has_"+d]);$('<div class="has-document document-new-instance hidden" data-document-name="'+d+'"><div class="document-upload"><input type="file" name="'+d+'" size="15" class="document-uploader"></div><div class="document-actions"><a href="" class="ui js-remove-document document-action">Delete</a></div></div>').appendTo(a).find("input[type=file]").on("change",
function(){$(this).closest(".has-document").removeClass("hidden");a.removeClass("hidden");b[0]["has_"+d]||b.append('<input type="hidden" name="has_'+d+'" value="1">')})[0].click()});
handle_ui.on("js-replace-document",function(a){var b=$(this).closest(".has-document");a=b.find(".document-uploader");b.find(".document-remover").val("");if(!a.length){a=+b.attr("data-dtype");var c=0<a?"opt"+a:"paperUpload";c='<div class="document-upload hidden"><input id="'+c+'" type="file" name="'+c+'"';b[0].hasAttribute("data-document-accept")&&(c+=' accept="'+b[0].getAttribute("data-document-accept")+'"');a=$(c+(' class="document-uploader'+(0<a?"":" js-check-submittable")+'"></div>')).appendTo(b).find(".document-uploader");
a.on("change",function(){b.find(".document-file, .document-stamps, .document-actions, .document-format, .js-replace-document").addClass("hidden");b.find(".document-upload").removeClass("hidden");b.find(".js-remove-document").removeClass("undelete").html("Delete");b.find(".js-replace-document").addClass("hidden")})}a[0].click()});
handle_ui.on("js-remove-document",function(a){a=$(this).closest(".has-document");var b=a.find(".document-remover"),c=a.find(".document-file"),d=$(this).closest("form");hasClass(this,"undelete")?(b.val(""),c.find("del > *").unwrap(),a.find(".document-stamps, .document-shortformat").removeClass("hidden"),$(this).removeClass("undelete").html("Delete")):a.hasClass("document-new-instance")?a.remove():(b.length||(b=$('<input type="hidden" class="document-remover" name="remove_'+a.data("documentName")+'" data-default-value="" value="1">').appendTo(a.find(".document-actions"))),
b.val(1),c.find("del").length||c.wrapInner("<del></del>"),a.find(".document-stamps, .document-shortformat").addClass("hidden"),$(this).addClass("undelete").html("Undelete"));form_highlight(d[0])});
handle_ui.on("js-withdraw",function(a){var b=$(this).closest("form");a=popup_skeleton({anchor:this,action:hoturl_post("paper",{p:hotcrp_paperid,m:"edit"})});a.push("<p>Are you sure you want to withdraw this submission from consideration and/or publication?");this.hasAttribute("data-revivable")||a.push(" Only administrators can undo this step.");a.push("</p>");a.push('<textarea name="reason" rows="3" cols="40" style="width:99%" placeholder="Optional explanation" spellcheck="true"></textarea>');if(!this.hasAttribute("data-withdrawable")){var c=
a.next_htctl_id();a.push('<div><input type="checkbox" name="override" value="1" id="'+c+'">&nbsp;<label for="'+c+'">Override deadlines</label></div>')}a.push_actions(['<button type="submit" name="withdraw" value="1" class="btn btn-primary">Withdraw</button>','<button type="button" name="cancel" class="btn">Cancel</button>']);a=a.show();transfer_form_values(a.find("form"),b,["doemail","emailNote"]);a.on("submit","form",function(){b.addClass("submitting")})});
handle_ui.on("js-delete-paper",function(a){var b=$(this).closest("form");a=popup_skeleton({anchor:this,action:hoturl_post("paper",{p:hotcrp_paperid,m:"edit"})});a.push("<p>Be careful: This will permanently delete all information about this submission from the database and <strong>cannot be undone</strong>.</p>");a.push_actions(['<button type="submit" name="delete" value="1" class="btn dangerous">Delete</button>','<button type="button" name="cancel" class="btn">Cancel</button>']);a=a.show();transfer_form_values(a.find("form"),
b,["doemail","emailNote"]);a.on("submit","form",function(){b.addClass("submitting")})});
handle_ui.on("js-clickthrough",function(a){var b=this,c=$(this).closest(".js-clickthrough-container");$.post(hoturl_post("api/clickthrough",{accept:1}),$(this).closest("form").serialize(),function(a){a&&a.ok?(c.find(".js-clickthrough-body").removeClass("hidden").find(".need-clickthrough-enable").prop("disabled",!1).removeClass("need-clickthrough-enable"),c.find(".js-clickthrough-terms").slideUp()):make_bubble(a&&a.error||"You can\u2019t continue to review until you accept these terms.","errorbubble").dir("l").near(b)})});
handle_ui.on("js-follow-change",function(a){var b=this;$.post(hoturl_post("api/follow",{p:$(b).attr("data-pid")||hotcrp_paperid}),{following:this.checked,reviewer:$(b).data("reviewer")||hotcrp_user.email},function(a){setajaxcheck(b,a);a.ok&&(b.checked=a.following)})});
var edit_paper_ui=function(a){function b(a,b,c){for(var d=0,e=[],f=0;f!=a.length;++f){var g=a[f],h;if(!(h=g.status<b)&&(h=c)){a:{h=g.tag;h=h.toLowerCase();for(var k=0;k!==c.length;++k){var m=c[k].toLowerCase();if(m===h||m.length>h.length&&"#"===m.charAt(h.length)&&m.substring(0,h.length)===h){h=!0;break a}}h=!1}h=!h}h||(d=Math.max(d,g.status),e.push('<a href="'+hoturl_html("search",{q:g.search||"#"+g.tag})+'" class="q">#'+g.tag+"</a>: "+g.message))}return[d,e]}function c(b){var c=a(this);b.preventDefault();
c.find("input").prop("disabled",!0);a.ajax(hoturl_post("api/settags",{p:c.attr("data-pid")}),{method:"POST",data:c.serialize(),timeout:4E3,success:function(b){c.find("input").prop("disabled",!1);c.find(".msg-error").remove();if(b.ok){foldup.call(c[0],null,{f:!0});var d=new a.Event("hotcrptags");a(window).trigger(d,[b])}else b.error&&c.find(".js-tag-editor").prepend(render_xmsg(2,b.error))}})}function d(c){var d=a(this).closest("form"),e=[],f=[];"submit"===c.type&&c.preventDefault();hasClass(d[0],
"submitting")||(d.addClass("submitting"),d.find("input").each(function(){var b=a(this).data("tagBase");if(b){f.push(this);var c="checkbox"===this.type?this.checked?this.value:"":a.trim(this.value);e.push(b+"#"+(""===c?"clear":c))}}),a.post(hoturl_post("api/settags",{p:d.attr("data-pid")}),{addtags:e.join(" ")},function(c){d.removeClass("submitting");if(c.ok){foldup.call(d[0],null,{f:!0});var g=a.Event("hotcrptags");a(window).trigger(g,[c]);g=b(c.tagreport,1,e)[1]}else focus_within(d),g=[c.error];
d.find(".psfn .savesuccess, .psfn .savefailure").remove();var h=a('<span class="save'+(c.ok?"success":"failure")+'"></span>');h.appendTo(d.find(".psfn").first());c.ok&&h.delay(1E3).fadeOut();g.length&&make_bubble(g.join("<br>"),"errorbubble").dir("l").near(a(f[0]).is(":visible")?f[0]:d.find(".psfn")[0]).removeOn(d.find("input"),"input").removeOn(document.body,"fold")}))}function e(b,c,d){if(a.isArray(d))return b=0<=d.indexOf(b),"="===c?b:!b;c={"=":2,"!=":5,"<":1,"<=":3,">=":6,">":4}[c];return b>d?
0!==(c&4):b==d?0!==(c&2):0!==(c&1)}function l(a,b){if(!1===a||!0===a)return a;if(f[a.type])return f[a.type](a,b);throw Error("unknown edit condition");}function k(){a(".has-edit-condition").each(function(){var b=a(this).closest("form"),c=JSON.parse(this.getAttribute("data-edit-condition"));toggleClass(this,"hidden",!l(c,b[0]))})}function g(a){if("submit"===a.type){var b=this.submitpaper;b&&"checkbox"===b.type&&!this.submitpaper.checked&&(window.confirm("Are you sure the paper is no longer ready for review?\n\nOnly papers that are ready for review will be considered.")||
a.preventDefault())}}var f={and:function(a,b){for(var c=0;c!==a.child.length;++c)if(!l(a.child[c],b))return!1;return!0},or:function(a,b){for(var c=0;c!==a.child.length;++c)if(l(a.child[c],b))return!0;return!1},not:function(a,b){return!l(a.child[0],b)},option:function(a,b){b=b["opt"+a.id];if(b instanceof HTMLInputElement)var c="radio"===b.type||"checkbox"===b.type?b.checked?b.value:0:b.value;else"value"in b&&(c=b.value);return e(+c,a.compar,a.value)},topic:function(b,c){if(!1===b.topics||!0===b.topics)return 0<
a(c).find(".topic-entry").filter(":checked").length===b.topics;for(var d=0;d!==b.topics.length;++d)if(c["top"+b.topics[d]].checked)return!0;return!1},title:function(b,c){return b.match===(""!==a.trim(c.title&&c.title.value))},abstract:function(b,c){return b.match===(""!==a.trim(c.abstract&&c.abstract.value))},collaborators:function(b,c){return b.match===(""!==a.trim(c.collaborators&&c.collaborators.value))},pc_conflict:function(a,b){for(var c=0,d,f=0;f!==a.cids.length;++f)if((d=b["pcc"+a.cids[f]])&&
("checkbox"===d.type?d.checked:0<+d.value)&&(++c,"!="===a.compar&&0===a.value))return!0;return e(c,a.compar,a.value)}};g.prepare_psedit=function(b){function c(b,c){a(d).find(".psfn .savesuccess, .psfn .savefailure").remove();var g=a('<span class="save'+(b?"success":"failure")+'"></span>');g.appendTo(a(d).find(".psfn"));b?g.delay(1E3).fadeOut():e.val(f);c&&make_bubble(c,"errorbubble").dir("l").near(g[0]);e.prop("disabled",!1)}var d=this,e=a(d).find("select, textarea").first(),f=e.val();e.on("change",
function(){var g=e.val();a.post(hoturl_post("api",b),a(d).find("form").serialize(),function(b){if(b.ok){c(!0);foldup.call(d,null,{f:!0});f=g;var h=a(d).find(".js-psedit-result").first();h.html(b.result||e[0].options[e[0].selectedIndex].innerHTML);b.color_classes&&make_pattern_fill(b.color_classes||"");h.closest("div.taghh").removeClass().addClass("taghh pscopen "+(b.color_classes||""))}else c(!1,b.error)});e.prop("disabled",!0)}).on("keyup",function(a){27!=(a.charCode||a.keyCode)||a.altKey||a.ctrlKey||
a.metaKey||(e.val(f),foldup.call(d,null,{f:!0}),a.preventDefault())})};g.prepare_pstags=function(){function d(a){if(a.ok&&a.tagreport){var c=b(a.tagreport,0);f.find(".want-tag-report").html(render_xmsg(c[0],c[1]));c=b(a.tagreport,1);f.find(".want-tag-report-warnings").html(render_xmsg(c[0],c[1]))}}var e=this,f="FORM"===this.tagName?a(e):a(e).find("form"),g=f.find("textarea");suggest(g,taghelp_tset);g.on("keydown",make_onkey("Enter",function(){f.find("input[name=save]").click()})).on("keydown",make_onkey("Escape",
function(){f.find("input[name=cancel]").click()}));f.find("input[name=cancel]").on("click",function(a){g.val(g.prop("defaultValue"));f.find(".msg-error").remove();foldup.call(g[0],a,{f:!0})});f.on("submit",c);f.closest(".foldc, .foldo").on("fold",function(b,c){c.f||(f.data("everOpened",!0),f.find("input").prop("disabled",!1),f.data("noTagReport")||a.get(hoturl("api/tagreport",{p:f.attr("data-pid")}),d),f.removeData("noTagReport"),g.autogrow(),focus_within(f[0]))});a(window).on("hotcrptags",function(b,
c){if(c.pid==f.attr("data-pid")){b=""==c.tags_view_html?"None":c.tags_view_html;var h=a(e).find(".js-tag-result").first();h.html()!==b&&h.html(b);!g.length||g.val()===c.tags_edit_text||g.is(":visible")||f.data("everOpened")&&a.trim(g.val()).split(/\s+/).sort().join(" ")===c.tags_edit_text.split(/\s+/).sort().join(" ")||g.val(c.tags_edit_text);d(c)}})};g.prepare_pstagindex=function(){var b="FORM"===this.tagName?a(this):a(this).find("form");b.on("submit",d);b.find("input").on("change",d)};g.edit_condition=
function(){k();a("#paperform").on("change click","input, select, textarea",k)};return g}($);
if(hotcrp_paperid)$(window).on("hotcrptags",function(a,b){b.pid==hotcrp_paperid&&(b.color_classes&&make_pattern_fill(b.color_classes,"",!0),$(".has-tag-classes").each(function(){var a=$.trim(this.className.replace(/(?: |^)\w*tag(?:bg)?(?= |$)/g," "));b.color_classes&&(a+=" "+b.color_classes);this.className=a}),$(".is-tag-index").each(function(){var a=$(this),d="",e=a.data("tagBase")+"#",l;"~"==e.charAt(0)&&"~"!=e.charAt(1)&&(e=hotcrp_user.cid+e);for(l=0;l!=b.tags.length;++l)b.tags[l].substr(0,e.length)==
e&&(d=b.tags[l].substr(e.length));"INPUT"!==this.tagName?a.text(d).closest(".is-nonempty-tags").toggleClass("hidden",""===d):"checkbox"===this.type?this.checked=""!==d:document.activeElement!==this&&(this.value=d)}),$("h1.paptitle .tagdecoration").remove(),b.tag_decoration_html&&$("h1.paptitle").append(b.tag_decoration_html))});
handle_ui.on("js-cannot-delete-user",function(a){a=popup_skeleton({anchor:this});a.push("<p><strong>This user cannot be deleted</strong> because they are the sole contact for "+$(this).data("soleAuthor")+". To delete the user, first remove these papers from the database or give the papers more contacts.</p>");a.push_actions(['<button type="button" name="cancel" class="btn">Cancel</button>']);a.show()});
handle_ui.on("js-delete-user",function(a){a=$(this).closest("form");a=popup_skeleton({anchor:this,action:a[0].action});var b;a.push("<p>Be careful: This will permanently delete all information about this user from the database and <strong>cannot be undone</strong>.</p>");(b=$(this).data("deleteInfo"))&&a.push(b);a.push_actions(['<button type="submit" name="delete" value="1" class="btn dangerous">Delete user</button>','<button type="button" name="cancel" class="btn">Cancel</button>']);a.show()});
handle_ui.on("js-plaintext-password",function(a){foldup.call(this);a=$(this).closest(".foldo, .foldc").hasClass("foldo");var b=$(this).closest("form")[0];b&&b.whichpassword&&(b.whichpassword.value=a?"t":"")});var profile_ui=function(a){return function(b){if(hasClass(this,"js-role")){var c=a(this).closest("form");b=c.find("input[name=pctype]:checked").val();c=c.find("input[name=ass]:checked").length;foldup.call(this,null,{n:1,f:!b||"no"===b});foldup.call(this,null,{n:2,f:(!b||"no"===b)&&0===c})}}}($);
handle_ui.on("js-decline-review",function(){var a=$(this).closest("form");a=popup_skeleton({anchor:this,action:a[0].action});a.push("<p>Select \u201cDecline review\u201d to decline this review. Thank you for your consideration.</p>");a.push('<textarea name="reason" rows="3" cols="40" style="width:99%" placeholder="Optional explanation" spellcheck="true"></textarea>');a.push_actions(['<button type="submit" name="refuse" value="yes" class="btn btn-primary">Decline review</button>','<button type="button" name="cancel" class="btn">Cancel</button>']);
a.show()});handle_ui.on("js-delete-review",function(){var a=$(this).closest("form");a=popup_skeleton({anchor:this,action:a[0].action});a.push("<p>Be careful: This will permanently delete all information about this review assignment from the database and <strong>cannot be undone</strong>.</p>");a.push_actions(['<button type="submit" name="deletereview" value="1" class="btn dangerous">Delete review</button>','<button type="button" name="cancel" class="btn">Cancel</button>']);a.show()});
handle_ui.on("js-edit-formulas",function(){function a(a,b){++l;a.push('<div class="editformulas-formula" data-formula-number="'+l+'">',"</div>");a.push('<div class="f-i"><div class="f-c">Name</div>');b.editable?(a.push('<div style="float:right"><a class="ui closebtn delete-link need-tooltip" href="#" style="display:inline-block;margin-left:0.5em" data-tooltip="Delete formula">x</a></div>'),a.push('<textarea class="editformulas-name" name="formulaname_'+l+'" rows="1" cols="60" style="width:37.5rem;width:calc(99% - 2.5em)">'+
escape_entities(b.name)+"</textarea>"),a.push('<hr class="c">')):a.push(escape_entities(b.name));a.push('</div><div class="f-i"><div class="f-c">Expression</div>');b.editable?a.push('<textarea class="editformulas-expression" name="formulaexpression_'+l+'" rows="1" cols="60" style="width:39.5rem;width:99%">'+escape_entities(b.expression)+"</textarea>").push('<input type="hidden" name="formulaid_'+l+'" value="'+b.id+'">'):a.push(escape_entities(b.expression));a.push_pop("</div>")}function b(b){"add"===
this.name&&(b=new HtmlCollector,a(b,{name:"",expression:"",editable:!0,id:"new"}),b=$(b.render()).appendTo(e.find(".editformulas")),b.find("textarea").autogrow(),focus_at(b.find(".editformulas-name")),e.find(".popup-bottom").scrollIntoView())}function c(){var a=$(this).closest(".editformulas-formula");a.find(".editformulas-expression").closest(".f-i").addClass("hidden");a.find(".editformulas-name").prop("disabled",!0).css("text-decoration","line-through");a.append('<em>(Formula deleted)</em><input type="hidden" name="formuladeleted_'+
a.data("formulaNumber")+'" value="1">')}function d(a){a.preventDefault();$.post(hoturl_post("api/namedformula"),e.find("form").serialize(),function(a){if(a.ok)location.reload(!0);else{e.find(".msg-error").remove();e.find(".editformulas").prepend($(render_xmsg(2,a.error)));e.find(".has-error").removeClass("has-error");for(var b in a.errf||{})e.find("input, textarea").filter("[name='"+b+"']").addClass("has-error")}})}var e,l=0;$.get(hoturl_post("api/namedformula"),function(k){if(k.ok){k=k.formulas;
var g=popup_skeleton(),f;g.push('<div style="max-width:480px;max-width:40rem;position:relative">',"</div>");g.push("<h2>Named formulas</h2>");g.push('<p><a href="'+hoturl("help","t=formulas")+'" target="_blank">Formulas</a>, such as \u201csum(OveMer)\u201d, are calculated from review statistics and paper information. Named formulas are shared with the PC and can be used in other formulas. To view an unnamed formula, use a search term like \u201cshow:(sum(OveMer))\u201d.</p>');g.push('<div class="editformulas">',
"</div>");for(f in k||[])a(g,k[f]);g.pop_push('<button type="button" name="add" class="btn">Add named formula</button>');g.push_actions(['<button type="submit" name="saveformulas" value="1" class="btn btn-primary">Save</button>','<button type="button" name="cancel" class="btn">Cancel</button>']);e=g.show();e.on("click","button",b);e.on("click","a.delete-link",c);e.on("submit","form",d)}})});
handle_ui.on("js-edit-view-options",function(){function a(a){$.ajax(hoturl_post("api/viewoptions"),{method:"POST",data:$(this).serialize(),success:function(a){a.ok&&popup_close(b)}});a.preventDefault()}var b;$.ajax(hoturl_post("api/viewoptions",{q:$("#searchform input[name=q]").val()}),{success:function(c){if(c.ok){var d=c.display_default;c=c.display_current;var e=popup_skeleton();e.push('<div style="max-width:480px;max-width:40rem;position:relative">',"</div>");e.push("<h2>View options</h2>");e.push('<div class="f-i"><div class="f-c">Default view options</div>',
"</div>");e.push('<div class="reportdisplay-default">'+escape_entities(d||"")+"</div>");e.pop();e.push('<div class="f-i"><div class="f-c">Current view options</div>',"</div>");e.push('<textarea class="reportdisplay-current" name="display" rows="1" cols="60" style="width:39.5rem;width:99%">'+escape_entities(c||"")+"</textarea>");e.pop();e.push_actions(['<button type="submit" name="save" class="btn btn-primary">Save options as default</button>','<button type="button" name="cancel" class="btn">Cancel</button>']);
b=e.show();b.on("submit","form",a)}}})});handle_ui.on("js-select-all",function(){$(this).closest("table.pltable").find("input[name='pap[]']").prop("checked",!0)});handle_ui.on("js-annotate-order",function(a){return plinfo_tags.edit_anno(this,a)});
var paperlist_ui=function(a){function b(b){var c=a(this),d=c.data("submitMark");c.removeData("submitMark");!d&&this.defaultact&&(d=a(this.defaultact).val());if(!d&&document.activeElement){var k=a(document.activeElement).closest("td");k.hasClass("lld")&&(k=k.closest(".linelink.active").find("input[type=submit], button[type=submit]"),1==k.length&&(d=this.defaultact.value=k[0].value))}c.find(".js-default-submit-values").remove();if(!c.find("input[name='pap[]']:checked").length)if((k=d&&c.find("input[type=submit], button[type=submit]").filter("[value="+
d+"]"))&&1==k.length&&k.data("defaultSubmitAll"))b=c.find("input[name='pap[]']").map(function(){return this.value}).get(),c.append('<div class="js-default-submit-values"><input type="hidden" name="pap" value="'+b.join(" ")+'"></div>');else{alert("Select one or more papers first.");b.preventDefault();return}b=c.data("originalAction");b||c.data("originalAction",b=this.action);d&&/^[-_\w]+$/.test(d)&&(c.find(".js-submit-action-info-"+d).each(function(){d+="-"+(a(this).val()||"")}),b=hoturl_add(b,"action="+
encodeURIComponent(d)));this.action=b}function c(a){"submit"===a.type&&b.call(this,a)}c.prepare_tag_listaction=function(){a("input.js-submit-action-info-tag").each(function(){"tag"===this.name&&suggest(this,taghelp_tset)});a("select.js-submit-action-info-tag").on("change",function(){var b=a(this).closest(".linelink"),c=b.find("select[name=tagfn]");foldup.call(b[0],null,{f:"cr"!==c.val(),n:99});foldup.call(b[0],null,{f:"cr"===c.val()||!b.find("input[name=tagcr_source]").val()&&"schulze"!==b.find("input[name=tagcr_method]").val()&&
!b.find("input[name=tagcr_gapless]").is(":checked")})}).trigger("change")};return c}($);
handle_ui.on("js-assign-review",function(a){var b,c;if("change"===a.type&&(c=/^assrev(\d+)u(\d+)$/.exec(this.name))&&(!(b=$(this).closest("form")[0])||!b.autosave||b.autosave.checked)){var d=this;if("SELECT"===d.tagName){a=b.rev_round;a={kind:"a",rev_round:a?a.value:""};var e=d.value}else a={kind:"c"},e=d.checked?-1:0;a["pcs"+c[2]]=e;$.post(hoturl_post("assign",{p:c[1],update:1,ajax:1}),a,function(a){"SELECT"===d.tagName?d.setAttribute("data-default-value",e):d.setAttribute("data-default-checked",
e?"1":"");setajaxcheck(d,a);form_highlight(b,d)})}});
(function(a){function b(b){if(a.isArray(b))return b;var c=[];b=b.match(/[-\d]+/g);if(!b)return!1;for(var d=0;d<b.length;++d){var e=b[d].indexOf("-");if(0<=e){var g=+b[d].substr(e+1);for(e=+b[d].substr(0,e);e<=g;++e)c.push(e)}else c.push(+b[d])}return c}function c(a){for(var b="string"===typeof a?1:0,c=wstorage.json(!1,"list_digests")||[],d=-1,e=now_msec(),g=0;g<c.length;++g){var k=c[g];k[b]===a?d=g:k[2]<e-3E4?(c.splice(g,1),--g):e<=k[0]&&(e=k[0]+1)}0<=d?c[d][2]=e:b&&(c.push([e,a,e]),d=c.length-1);
wstorage(!1,"list_digests",c);return 0<=d?c[d][1-b]:!1}function d(a){var b,d;return 0>a.indexOf('"ids":')&&(b=/^(.*)"digest":"listdigest([0-9]+)(".*)$/.exec(a))&&!1!==(d=c(+b[2]))?b[1]+'"ids":"'+d+b[3]:a}function e(e,f){if(e){/"digest":/.test(e)&&(e=d(e));if(1500<e.length){var g=/^(.*)"ids":"([-0-9']+)"(.*)/.exec(e),h;if(g&&wstorage()&&(h=c(g[2]))){e=g[1]+'"digest":"listdigest'+h+'"';if(f){h=b(g[2]);var l;h&&0<=(l=a.inArray(f,h))&&(e+=',"curid":'+f+',"previd":'+(0<l?h[l-1]:"false")+',"nextid":'+(l<
h.length-1?h[l+1]:"false"))}e+=g[3]}}k=now_msec();f="; max-age=20";var v;siteurl&&(v=/^[a-z]+:\/\/[^\/]*(\/.*)/.exec(hoturl_absolute_base()))&&(f+="; path="+v[1]);document.cookie="hotlist-info="+encodeURIComponent(e)+siteurl_cookie_params+f}}function l(b,c){var d,f;if(c&&c.substring(0,siteurl.length)===siteurl&&/^(?:paper|review|assign|profile)(?:|\.php)\//.test(f=c.substring(siteurl.length))&&(d=a(b).closest(".has-hotlist")).length){b=d.attr("data-hotlist");if(d.is("table.pltable")&&document.getElementById("footer")){var g=
c=-100,k,l=[];for(d=d.children("tbody.pltable")[0].firstChild;d;d=d.nextSibling)"TR"===d.nodeName&&/^pl(?:\s|z)/.test(d.className)&&(k=+d.getAttribute("data-pid"))&&(k!=g+1&&(0<c&&l.push(c==g?c:c+"-"+g),c=k),g=k);0<c&&l.push(c==g?c:c+"-"+g);b=b.replace(/"ids":"[-0-9']+"/,'"ids":"'+l.join("'")+'"')}f=/^[^\/]*\/(\d+)(?:$|[a-zA-Z]*\/)/.exec(f);e(b,f?+f[1]:null)}}var k;handle_ui.on("js-edit-comment",function(a){return papercomment.edit_id(this.hash.substring(1))});a(document).on("click","a",function(a){hasClass(this,
"fn5")?foldup.call(this,a,{n:5,f:!1}):hasClass(this,"ui")||l(this,this.getAttribute("href"))});a(document).on("submit","form",function(a){hasClass(this,"submit-ui")?handle_ui.call(this,a):l(this,this.getAttribute("action"))});a(document).on("click","tr.pl",function(b){a(b.target);if("A"!==b.target.tagName&&"INPUT"!==b.target.tagName&&"TEXTAREA"!==b.target.tagName&&"SELECT"!==b.target.tagName&&hasClass(this.parentElement,"pltable")){for(var c=this;1!==c.nodeType||/^plx/.test(c.className);)c=c.previousSibling;
if(hasClass(this.parentElement.parentElement,"pltable-focus-checkbox"))a(c).find("input[type=checkbox]").focus().scrollIntoView(),b.preventDefault();else if(hasClass(b.target,"pl_id")||hasClass(b.target,"pl_title")||a(b.target).closest("td").hasClass("pl_rowclick")){c=a(c).find("a.pnum").first();var d=c[0].getAttribute("href");l(c[0],d);event_key.is_default_a(b)?window.location=d:(window.open(d,"_blank").blur(),window.focus());b.preventDefault()}}});a(window).on("beforeunload",function(){var a=document.body.getAttribute("data-hotlist");
a&&(!k||k+3<now_msec())&&e(a)});a(function(){var c=!1;a(".has-hotlist").each(function(){var a=this.getAttribute("data-hotlist");a&&(a=d(a))&&(this.setAttribute("data-hotlist",a),c=!0)});c&&hotcrp_paperid&&!$$("quicklink_prev")&&!$$("quicklink_next")&&a(".quicklinks").each(function(){var c=a(this).closest(".has-hotlist");c=JSON.parse(c.attr("data-hotlist")||"null");var d,e;c&&c.ids&&(d=b(c.ids))&&0<=(e=a.inArray(hotcrp_paperid,d))&&(0<e&&a(this).prepend('<a id="quicklink_prev" class="x" href="'+hoturl_html("paper",
{p:d[e-1]})+'">&lt; #'+d[e-1]+"</a> "),e<d.length-1&&a(this).append(' <a id="quicklink_next" class="x" href="'+hoturl_html("paper",{p:d[e+1]})+'">#'+d[e+1]+" &gt;</a>"))})})})($);
function hotlist_search_params(a,b){a instanceof HTMLElement&&(a=a.getAttribute("data-hotlist"));a&&"string"===typeof a&&(a=JSON.parse(a));var c;if(!a||!a.ids||!(c=a.listid.match(/^p\/(.*?)\/(.*?)(?:$|\/)(.*)/)))return!1;a={q:b?a.ids.replace(/'/g," "):urldecode(c[2]),t:c[1]||"s"};if(c[3])for(c=c[3].split(/[&;]/),b=0;b<c.length;++b){var d=c[b].indexOf("=");a[c[b].substr(0,d)]=urldecode(c[b].substr(d+1))}return a}
$(function(){$(".js-radio-focus").on("click keypress","input, select",function(a){a=$(this).closest(".js-radio-focus").find("input[type=radio]").first();a.length&&a[0]!==this&&a[0].click()})});
function populate_pcselector(){var a=this.getAttribute("data-pcselector-options")||"*";a="["===a.charAt(0)?JSON.parse(a):a.split(/[\s,]+/);for(var b=this.getAttribute("data-pcselector-selected"),c=0,d="last"===hotcrp_pc.__sort__,e={},l=0;l<a.length;++l){""!==a[l]&&"*"!==a[l]||a.splice.apply(a,[l,1].concat(hotcrp_pc.__order__));var k=+a[l],g;if(k)if(g=hotcrp_pc[k]){var f=g.email;var m=g.name;if(d&&g.lastpos){var h=g.emailpos?g.emailpos-1:m.length;m=m.substring(g.lastpos,h)+", "+m.substring(0,g.lastpos-
1)+m.substring(h)}}else continue;else if(f="none",m=a[l],""===m||"0"===m)m="None";!e[f]&&(e[f]=!0,g=document.createElement("option"),g.setAttribute("value",f),g.text=m,this.add(g),f===b||"none"!==f&&k==b)&&(c=this.options.length-1)}this.selectedIndex=c;$(this).removeClass("need-pcselector")}$(function(){$(".need-pcselector").each(populate_pcselector)});
var make_score_info=function(a){function b(a){if(1>=a)return function(a){return 1};a=1/(a-1);return function(b){return(+b-1)*a}}function c(a){return a.toFixed(a==Math.round(a)?0:2)}function d(a){return parseInt(a,10)}function e(a,b){return a==b?a:a>b?e(a-b,b):e(a,b-a)}function l(a,b){return function(c,d){if(.8>c||c>a+.2)return c.toFixed(2);var f=Math.ceil(c),g=String.fromCharCode(b+a-f);if(c==f)return g;var k=String.fromCharCode(b+a-f+1);d=d||2;c=Math.floor((f-c)*d+.5);if(0>=c||c>=d)return 0>=c?g:
k;f=e(c,d);for(var h=0,l="";h<d;h+=f)l+=h<c?g:k;return l}}function k(a,b){return function(c){var d;c=c.toUpperCase();return 1==c.length&&(d=c.charCodeAt(0))>=b&&d<b+a?a-(d-b):null}}function g(e,g,m){function h(a){return Math.max(Math.min(Math.floor(8.99*v(a))+1,9),1)}function r(b){b=m+h(b);if(!f[b]){var c=a('<span class="svb hidden '+b+'"></span>').appendTo(document.body),d;f[b]=[0,0,0];if(d=/^\s*rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)[\s,)]/.exec(c.css("color")))f[b]=[+d[1],+d[2],+d[3]];c.remove()}return f[b]}
var v=b(e);var t=g?l(e,g):c;return{fm:v,rgb_array:r,rgb:function(a){a=r(a);return sprintf("#%02x%02x%02x",a[0],a[1],a[2])},unparse:t,unparse_html:function(a){return.95<=a&&a<=e+.05?'<span class="sv '+m+h(a)+'">'+t(a)+"</span>":c(a)},unparse_revnum:function(a){return 1<=a&&a<=e?'<span class="rev_num sv '+m+h(a)+'">'+t(a)+".</span>":"(???)"},parse:g?k(e,g):d,value_order:function(){var a=[],b;for(b=g?e:1;1<=b&&b<=e;b+=g?-1:1)a.push(b);return a},className:function(a){return m+h(a)}}}var f={},m={};return function(a,
b,c){"string"===typeof b&&(b=b.charCodeAt(0));var d=a+"/"+(b||"")+"/"+(c||"sv");m[d]||(m[d]=g(a,b||"",c||"sv"));return m[d]}}(jQuery),scorechart=function(a){function b(a){var b={v:[],max:0,h:0,c:0,sum:0,sv:"sv"};var c=/(?:^|[&;])v=(.*?)(?:[&;]|$)/.exec(a);var d=c[1].split(/,/);for(c=0;c<d.length;++c){var e=/^\d+$/.test(d[c])?parseInt(d[c],10):0;b.v[c+1]=e;b.max=Math.max(b.max,e);b.sum+=e}if(c=/(?:^|[&;])h=(\d+)(?:[&;]|$)/.exec(a))b.h=parseInt(c[1],10);e=0;if(c=/(?:^|[&;])c=([A-Z])(?:[&;]|$)/.exec(a))b.c=
c[1].charCodeAt(0),e=String.fromCharCode(b.c+2-b.v.length);if(c=/(?:^|[&;])sv=([^;&]*)(?:[&;]|$)/.exec(a))b.sv=decodeURIComponent(c[1]);b.fx=make_score_info(d.length,e,b.sv);return b}function c(a){return sprintf("#%02x%02x%02x",a[0],a[1],a[2])}function d(){var d=this.getAttribute("data-scorechart");if(!this.firstChild||this.firstChild.getAttribute("data-scorechart")!==d){for(;this.firstChild;)this.removeChild(this.firstChild);if(/.*&s=1$/.test(d)&&e){var f=b(d);var m=5*(f.v.length-1)+3,h=5*Math.max(f.max,
1)+3,r='<svg width="'+m+'" height="'+h+'" style="font:6.5px Menlo, Monaco, source-code-pro, Consolas, Terminal, monospace;user-select:none">',v=c(k);r+='<path style="stroke:'+v+';fill:none" d="M0.5 '+(h-5-1)+"v5.5h"+(m-1)+'v-5.5" />';(f.c?f.v[f.v.length-1]:f.v[1])||(r+='<text x="2" y="'+(h-2)+'" fill="'+v+'">'+(f.c?String.fromCharCode(f.c-f.v.length+2):1)+"</text>");(f.c?f.v[1]:f.v[f.v.length-1])||(r+='<text x="'+(m-1.75)+'" y="'+(h-2)+'" text-anchor="end" fill="'+v+'">'+(f.c?String.fromCharCode(f.c):
f.v.length-1)+"</text>");for(m=1;m<f.v.length;++m)if(v=f.c?f.v.length-m:m,f.v[v]){var n=f.fx.rgb_array(v),w=v==f.h?2:1;if(2==w){var y=.5;y=[l[0]*y+.5*n[0],l[1]*y+.5*n[1],l[2]*y+.5*n[2]];r+='<path style="fill:'+c(y)+'" d="'+("M"+(5*m-3)+" "+(h-1-5)+"h4v4h-4z")+'" />'}if(w<=f.v[v]){for(r+='<path style="fill:'+c(n)+'" d="';w<=f.v[v];++w)r+="M"+(5*m-3)+" "+(h-1-5*w)+"h4v4h-4z";r+='" />'}}f=a(r+"</svg>")[0]}else if(/.*&s=2$/.test(d)&&e){f=document.createElement("canvas");h=b(d);v=m=0;n=f.getContext("2d");
w=window.devicePixelRatio||1;r=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;var t=w/r;y=Math.ceil(64*t);t=Math.ceil(8*t);f.width=y;f.height=t;w!==r&&(f.style.width="64px",f.style.height="8px",n.scale(y/64,t/8));for(w=1;w<h.v.length;++w)r=h.c?h.v.length-w:w,h.v[r]&&(n.fillStyle=c(h.fx.rgb_array(r)),m+=h.v[r],r=Math.round(65*m/h.sum),r>v&&n.fillRect(v,0,r-v-1,8),v=r)}else f=document.createElement("img"),
f.src=hoturl("scorechart",d),f.alt=this.getAttribute("title");f.setAttribute("data-scorechart",d);this.insertBefore(f,null)}}var e=function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),l=[0,0,0],k=[190,190,255];return function(b){if(null==b||b===a)b=a(".need-scorechart");b.each(d).removeClass("need-scorechart").addClass("scorechart")}}(jQuery),unfold_events=function(a){function b(){a.ajax(hoturl("api/events",e?{from:e}:null),{method:"GET",cache:!1,success:function(b){b.ok&&
(d=(d||[]).concat(b.rows),e=b.to,a(".has-events").each(function(){c(this,b.rows);!1===b.more&&a(this).find(".eventtable-more").addClass("hidden")}))}})}function c(c,d){var e=a(c).find("tbody");e.length||(a(c).append('<div class="eventtable"><table class="pltable"><tbody class="pltable"></tbody></table></div><div class="g eventtable-more"><button class="btn" type="button">More</button></div>'),a(c).find("button").on("click",b),e=a(c).find("tbody"));for(c=0;c<d.length;++c)e.append(d[c])}var d=null,
e=0;return function(e){e=a(e);e.find(".has-events").length||(e=a('<div class="fx20 has-events"></div>').appendTo(e),d?c(e[0],d):b())}}(jQuery);function textarea_shadow(a,b){return jQuery("<div></div>").css({position:"absolute",top:-1E4,left:-1E4,width:b||a.width(),fontSize:a.css("fontSize"),fontFamily:a.css("fontFamily"),fontWeight:a.css("fontWeight"),lineHeight:a.css("lineHeight"),resize:"none","word-wrap":"break-word",whiteSpace:"pre-wrap"}).appendTo(document.body)}
(function(a){function b(){for(var a=l.length-1;0<=a;--a)l[a]()}function c(a,b){var c=a.data("autogrower");a.removeData("autogrower");b&&b.remove();for(a=l.length-1;0<=a;--a)l[a]===c&&(l[a]=l[l.length-1],l.pop())}function d(b){var d,e,k;return function(f){if(!1===f)return c(b,d);var g=b.width();if(!(0>=g)){d||(d=textarea_shadow(b,g),e=b.height(),k=d.text("!").height());var h=b[0].value;f&&"keydown"==f.type&&13===f.keyCode&&(h+="\n");d.css("width",g).text(h+"...");f=Math.max(a(window).height()-4*k,
4*k);b.height(Math.min(f,Math.max(d.height(),e)))}}}function e(b){var d;return function(e){if(!1===e)return c(b,d);var f=b.outerWidth();if(!(0>=f)){d||(d=textarea_shadow(b,f),e=b.css(["paddingRight","paddingLeft","borderLeftWidth","borderRightWidth"]),d.css({width:"auto",display:"table-cell",paddingLeft:parseFloat(e.paddingRight)+parseFloat(e.paddingLeft)+parseFloat(e.borderLeftWidth)+parseFloat(e.borderRightWidth)+"px"}),e=b.css(["minWidth","maxWidth"]),"0px"==e.minWidth&&b.css("minWidth",f+"px"),
"none"!=e.maxWidth||b.hasClass("wide")||b.css("maxWidth","640px"));d.text(b[0].value+"  ");e=b.css(["minWidth","maxWidth"]);f=Math.min(d.outerWidth(),a(window).width());var g=parseFloat(e.maxWidth);g===g&&(f=Math.min(f,g));b.outerWidth(Math.max(f,parseFloat(e.minWidth)))}}}var l=null;a.fn.autogrow=function(){this.each(function(){var c=a(this),g=c.data("autogrower");g||("TEXTAREA"===this.tagName?g=d(c):"INPUT"===this.tagName&&"text"===this.type&&(g=e(c)),g&&(c.data("autogrower",g).on("change input",
g),l||(l=[],a(window).resize(b)),l.push(g)));g&&""!==c.val()&&g()});return this};a.fn.unautogrow=function(){this.each(function(){var b=a(this).data("autogrower");b&&b(!1)});return this}})(jQuery);$(function(){$(".need-autogrow").autogrow().removeClass("need-autogrow")});
